//github.com/LMLBLMY/CharWar  版本  V5.38
EXPORT CharWar()
BEGIN
STARTAPP("Function");STARTVIEW(-7);

LOCAL Black,v0,xp,yp,vx,vy;
LOCAL Play,t,x0,y0,Dir,Sua,Direct,a;
LOCAL x1,y1,AFlue1,Flue1,Poi1,Lp1,Skill,Players;
LOCAL x2,y2,AFlue2,Flue2,Poi2,Lp2,d1,d2;
LOCAL x3,y3,AFlue3,Flue3,Poi3,Lp3,d3,d9;
LOCAL Inj,Round,Bomb,Cost,ax,ay,r,Rep;
LOCAL Pack,x9,y9,SinP,Shield1,Shield2,Shield3,times;
LOCAL Comp,Ref1,Ref2,Ref3,Move1,Move2,Move3;
LOCAL tx,ty,p2,p4,p6,p8,Tset;

16763080?Black;     //RGB(255,200,200)
//16435400?Black;
Xmax:=15.9; Xmin:=-15.9; Ymax:=10.9; Ymin:=-10.9; AAngle :=2;
K:=0; -1?M;
MSGBOX("离高考还剩:"+DateDays(Date,2023.0607));
CHOOSE(M,"选择模式","双人","三人","双人+电脑");
IF M=-1 THEN KILL; END;
C:=6.66; D:=0; S:=1; Cover; 
IF M=1 THEN Players:=2; END;
IF M=2 THEN Players:=3; Lp3:=4800; END;
IF M=3 THEN MSGBOX("请期待"); Players:=2; END; 
IF K=0 OR K=15 OR K=4 THEN 1?S;
TRUNCATE(RANDOM(-14,14),1)?x1;TRUNCATE(RANDOM(-14,14),1)?x2;TRUNCATE(RANDOM(-14,14),1)?x3;
13?y1?y2?y3;
0?R?V?T; Pack:=3; -99?y9; 1?Play?Bomb; 125?Inj; 20?θ; 1?Dir?M9(10,4); 10?v0; 20?d1?d2?d3?d9?M9(10,5);
10?Flue1?Flue2?Flue3; 40?AFlue1?AFlue2?AFlue3; 4800?Lp1?Lp2; 
2?Poi1?Poi2?Poi3;
[[0,0,0,2,1,2,1,6,1,4,0,2,0,1,2,3,3,4,2,4,3,4],
[0,0,0,2,1,2,1,6,1,4,0,2,0,1,2,3,3,4,2,4,3,4],
[0,0,0,2,1,2,1,6,1,4,0,2,0,1,2,3,3,4,2,4,3,4]]?M9;
-99?M9(10,1); -99?M9(10,2); 0?M9(10,3);
  IF ISKEYDOWN(15) OR K=15 THEN
665?Poi1?Poi2?Poi3; M:=-9.9; 100?AFlue1?AFlue2?AFlue3;
[[0,0,0,200,100,200,100,400,100,200,0,200,0,100,200,300,300,400,200,300,300,400],
[0,0,0,200,100,200,100,400,100,200,0,200,0,100,200,300,300,400,200,300,300,400],
[0,0,0,200,100,200,100,400,100,200,0,200,0,100,200,300,300,400,200,300,300,400]]?M9;
-99?M9(10,1); -99?M9(10,2); 0?M9(10,3); -9.9?M9(5,20);
 END;
ELSE
 IFERR M9(5,1)?A; THEN MSGBOX("无存档!"); CharWar(); END; 
20?θ; 1?Dir; 10?v0; 20?d1?d2?d3; 0?R; 1?Bomb; 125?Inj;
M9(6,1)?Players; M9(6,2)?Play; M9(6,3)?Direct; M9(6,4)?a; M9(6,5)?Round; M9(6,6)?Pack; M9(6,7)?x9; M9(6,8)?y9; M9(6,9)?SinP; M9(6,10)?Comp; M9(5,20)?M;
M9(7,1)?x1; M9(7,2)?y1; M9(7,3)?AFlue1; M9(7,4)?Flue1; M9(7,5)?Poi1; M9(7,6)?Lp1; M9(7,7)?Shield1; M9(7,8)?Ref1;
M9(8,1)?x2; M9(8,2)?y2; M9(8,3)?AFlue2; M9(8,4)?Flue2; M9(8,5)?Poi2; M9(8,6)?Lp2; M9(8,7)?Shield2; M9(8,8)?Ref2;
M9(9,1)?x3; M9(9,2)?y3; M9(9,3)?AFlue3; M9(9,4)?Flue3; M9(9,5)?Poi3; M9(9,6)?Lp3; M9(9,7)?Shield3; M9(9,8)?Ref3;
(x1-M9(10,1))*y1?M9(5,4);  (x2-M9(10,1))*y2?M9(5,5); (x3-M9(10,1))*y3?M9(5,6);
END;
IF K=0 OR K=15 OR K=4 THEN
 M9(7,9):=3; M9(8,9):=3; M9(9,9):=3;
 IF M=-9.9 OR M9(5,20) THEN M9(7,9):=300; M9(8,9):=300; M9(9,9):=300; END;
END;
WAIT(0.5);
BLIT(G1);

IFERR M9(11,1) THEN
12?M9(11,1); Z:=0;
WHILE Z<M9(11,1) DO Z:=Z+1;
M9(11,3*Z-1):=1;
M9(11,3*Z):=ROUND(RANDOM(-15,15),1);
M9(11,3*Z+1):=15;
END;
END;

REPEAT
  IF GETPIX(x1+0.2,y1-1.4)≠Black AND GETPIX(x1+1,y1-1.4)≠Black THEN
  RECT(x1,y1,x1+1.3,y1-1.2);
  y1-0.1?y1;
  TEXTOUT("我",x1,y1,3,RGB(150,230,180));
  END;
UNTIL GETPIX(x1+0.2,y1-1.4)=Black OR GETPIX(x1+1,y1-1.4)=Black OR y1≤-16
END;

REPEAT
  IF GETPIX(x2+0.2,y2-1.4)≠Black AND GETPIX(x2+1,y2-1.4)≠Black THEN
  RECT(x2,y2,x2+1.3,y2-1.2);
  y2-0.1?y2;
  TEXTOUT("你",x2,y2,3,RGB(50,150,255));
  END;
UNTIL GETPIX(x2+0.2,y2-1.4)=Black OR GETPIX(x2+1,y2-1.4)=Black OR y2≤-16
END;

IF Players=3 THEN
REPEAT
  IF GETPIX(x3+0.2,y3-1.4)≠Black AND GETPIX(x3+1,y3-1.4)≠Black THEN
  RECT(x3,y3,x3+1.3,y3-1.2);
  y3-0.1?y3;
  TEXTOUT("他",x3,y3,3,RGB(200,160,180));
  END;
UNTIL GETPIX(x3+0.2,y3-1.4)=Black OR GETPIX(x3+1,y3-1.4)=Black OR y3≤-16
END;
ELSE
-99?x3?y3;
END;

Z:=0;
REPEAT Z:=Z+1;
TEXTOUT("投放地雷中...正在: "+Z,-15.6,8,3,RGB(50,50,120),400,RGB(255,255,255));
 WHILE GETPIX(M9(11,3*Z)+.2,M9(11,3*Z+1)-1)≠Black AND GETPIX(M9(11,3*Z)+.8,M9(11,3*Z+1)-1)≠Black AND M9(11,3*Z+1)>-16 DO
 RECT(M9(11,3*Z),M9(11,3*Z+1),M9(11,3*Z)+.9,M9(11,3*Z+1)-1);
 M9(11,3*Z+1):=M9(11,3*Z+1)-0.1;
 TEXTOUT("雷",M9(11,3*Z),M9(11,3*Z+1),1,RGB(50,30,60)); 
 END;
UNTIL Z=M9(11,1) END;
RECT(-16,8,3,6);
S:=0; Sua:=0; Cover;
TICKS?M9(5,1);

REPEAT  //Main Loop
IF M=-9.9 OR M9(5,20)=-9.9 THEN
IF ISKEYDOWN(15) THEN C:=2.22; Cover; Sua:=0; S:=-2; Cover; END;
IF ISKEYDOWN(14) THEN K:=14; END;
IF K=14 THEN t:=0.001;
IF Skill≤3 OR Skill=7 OR Skill=8 OR Skill=9 OR Skill=13 OR Skill=16 OR Skill=19 THEN
 V:=3.33; TRUNCATE(RANDOM(1,5))?t;
END;
IF ISKEYDOWN(5) AND v0≠42 AND Round≠0 THEN C:=-9.99; Cover;
M9(6,1)?Players; M9(6,2)?Play; M9(6,3)?Direct; M9(6,4)?a; M9(6,5)?Round; 
M9(6,6)?Pack; M9(6,7)?x9; M9(6,8)?y9; M9(6,9)?SinP;
M9(7,1)?x1; M9(7,2)?y1; M9(7,6)?Lp1; M9(7,7)?Shield1;
M9(8,1)?x2; M9(8,2)?y2; M9(8,6)?Lp2; M9(8,7)?Shield2;
M9(9,1)?x3; M9(9,2)?y3; M9(9,6)?Lp3; M9(9,7)?Shield3;
Sua:=0; BLIT(G1); V:=0;
END;
 IF ISKEYDOWN(20) OR ISKEYDOWN(21) OR ISKEYDOWN(22) OR ISKEYDOWN(23) THEN
IF ISKEYDOWN(20) THEN X:=x1+0.6; Y:=y1-.6; END;
IF ISKEYDOWN(21) THEN X:=x2+0.6; Y:=y2-.6; END;
IF ISKEYDOWN(22) THEN X:=x3+0.6; Y:=y3-.6; END;
IF ISKEYDOWN(23) AND SinP≠0 THEN X:=x9+.6; Y:=y9-.6; END;
IF ISKEYDOWN(24) AND M9(10,3)>0 THEN X:=M9(10,1); Y:=M9(10,2); END;
 (Y-y0+5*t^2)/t?vy;
 Dir*(X-x0-a*t^2)/t?vx;
END;
IF ISKEYDOWN(7) OR ISKEYDOWN(8) THEN 10?Flue1?Flue2?Flue3; END;
IF Skill=3 OR Skill=7 THEN a:=0; END;
IF Skill=9 THEN a:=0.3*a; END;
 Comp:=1; t:=0;
 END;
END;

IF Lp1>0 AND y1>-16 THEN
  IF GETPIX(x1+0.2,y1-1.4)≠Black AND GETPIX(x1+1,y1-1.4)≠Black THEN
  RECT(x1,y1,x1+1.3,y1-1.2);
  y1-0.1?y1;
  TEXTOUT("我",x1,y1,3,RGB(150,230,180));
  END;
END;
IF Lp2>0 AND y2>-16 THEN
  IF GETPIX(x2+0.2,y2-1.4)≠Black AND GETPIX(x2+1,y2-1.4)≠Black THEN
  RECT(x2,y2,x2+1.3,y2-1.2);
  y2-0.1?y2;
  TEXTOUT("你",x2,y2,3,RGB(50,150,255));
  END;
END;
IF Players=3 AND Lp3>0 AND y3>-16 THEN
  IF GETPIX(x3+0.2,y3-1.4)≠Black AND GETPIX(x3+1,y3-1.4)≠Black THEN
  RECT(x3,y3,x3+1.3,y3-1.2);
  y3-0.1?y3;
  TEXTOUT("他",x3,y3,3,RGB(200,160,180));
 END;
END;
IF SinP≠0 THEN
 IF GETPIX(x9-.4,y9-1.1)≠Black AND GETPIX(x9+.4,y9-1.1)≠Black THEN
   y9:=y9-0.1;
   IF y9≤-16 THEN SinP:=0; -99?x9?y9; END;
   TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(100,255,200),100,RGB(255,255,255));
 END;
END;
IF M9(10,3)>0 THEN
 IF GETPIX(M9(10,1)-.4,M9(10,2)-.7)≠Black AND GETPIX(M9(10,1)+.4,M9(10,2)-.7)≠Black THEN
   M9(10,2):=M9(10,2)-0.1;
   IF M9(10,2)≤-16 THEN M9(10,3):=0; -99?M9(10,1); -99?M9(10,2); END;
   TEXTOUT("枪",M9(10,1)-0.5,M9(10,2)+0.5,1,RGB(255,200,100),100,RGB(255,255,255));
 END;
END;

IF M9(10,3)>0 AND r≠-.3 AND r≠6.1 AND M9(10,4)=0 AND V≠3.33 THEN
 IF Lp1>0 THEN (ROUND(x1,1)-M9(10,1))*ROUND(y1,1)?M9(5,8);  END; IF Lp2>0 THEN (ROUND(x2,1)-M9(10,1))*ROUND(y2,1)?M9(5,9); END; IF Lp3>0 THEN (ROUND(x3,1)-M9(10,1))*ROUND(y3,1)?M9(5,10); END;
IF M9(5,11)=1 THEN M9(5,4)?M9(5,8); END; IF M9(5,11)=2 THEN M9(5,5)?M9(5,9); END; IF M9(5,11)=3 THEN M9(5,6)?M9(5,10); END;
  IF (M9(5,4)≠M9(5,8) AND Lp1>0) OR (M9(5,5)≠M9(5,9) AND Lp2>0) OR (M9(5,6)≠M9(5,10) AND Lp3>0) THEN
     IF M9(5,4)≠M9(5,8) AND Lp1>0 THEN X:=x1+.6; Y:=y1-.6; END;
     IF M9(5,5)≠M9(5,9) AND Lp2>0 THEN X:=x2+.6; Y:=y2-.6; END;
     IF M9(5,6)≠M9(5,10) AND Lp3>0 THEN X:=x3+.6; Y:=y3-.6; END;
     M9(10,7):=0; M9(10,8):=0; M9(10,9):=0; 
 //L:=(Y-M9(10,2))/(X-M9(10,1));
   IF X≥M9(10,1) THEN M9(10,12):=1; ELSE M9(10,12):=-1; END;
 Z:=0; Inj:=35; M9(10,13):=0; IF X=M9(10,1) THEN X:=M9(10,1)+0.01; END;
 M9(10,10):=COS(ATAN(M9(10,12)*(Y-M9(10,2))/(X-M9(10,1))))*30; M9(10,11):=SIN(ATAN(M9(10,12)*(Y-M9(10,2))/(X-M9(10,1))))*30;
   IF M9(10,6)≠0 THEN Inj:=28; END;
  WHILE Z<6 DO
// TEXTOUT([M9(10,1),M9(10,2)],-15.6,-3,2,RGB(0,0,0),300,RGB(255,255,255),Made by LMLB);
  IF -17≤xp AND xp≤17 THEN
   //  IF M9(10,1)≥X THEN xp:=xp-0.2; ELSE xp:=xp+0.2; END;  yp:=L*(xp-X)+Y-0.5;
   M9(10,13):=M9(10,13)+0.02;
   xp:=M9(10,1)+M9(10,12)*M9(10,10)*M9(10,13); yp:=M9(10,2)+M9(10,11)*M9(10,13);
   TEXTOUT("炮",xp-.5,yp+.5,1,RGB(50,50,50),100,RGB(255,255,255));
   ELSE xp:=M9(10,1); yp:=M9(10,2);
  END;
   //d1:=√((X+.5-xp)^2+(Y-.5-yp)^2);
   IF (ABS(X-xp)≤0.8 AND ABS(Y-yp)≤0.8) OR GETPIX(xp-.7,yp+.7)=Black OR GETPIX(xp+0.6,yp+0.7)=Black OR GETPIX(xp-0.7,yp-.4)=Black OR GETPIX(xp+0.6,yp-0.4)=Black THEN
 Z:=Z+1; M9(10,13):=0;
 d1:=√((x1+.5-xp)^2+(y1-.5-yp)^2);
 d2:=√((x2+.5-xp)^2+(y2-.5-yp)^2);
 d3:=√((x3+.5-xp)^2+(y3-.5-yp)^2);
   ARC(G1,xp,yp+.1,10,{RGB(255,255,255),RGB(255,255,255)});
   BLIT(G1);
   TEXTOUT("我",x1,y1,3,RGB(150,230,180));
   TEXTOUT("你",x2,y2,3,RGB(50,150,255));
   TEXTOUT("他",x3,y3,3,RGB(200,160,180));
   IF d1≤1.2 OR d2≤1.2 OR d3≤1.2 THEN
   M9(4,M9(5,11)+1):=M9(4,M9(5,11)+1)+Inj; M9(4,1):=M9(4,1)+Inj;
    IF d1≤1.2 THEN M9(10,7):=M9(10,7)+Inj; 
     IF Shield1≥Inj THEN Shield1:=Shield1-Inj; ELSE Lp1:=Lp1+Shield1-Inj; Shield1:=0; END;
     TEXTOUT(M9(10,7),x1,y1+1,2,RGB(150,50,0)); END;
    IF d2≤1.2 THEN M9(10,8):=M9(10,8)+Inj; 
     IF Shield2≥Inj THEN Shield2:=Shield2-Inj; ELSE Lp2:=Lp2+Shield2-Inj; Shield2:=0; END;
     TEXTOUT(M9(10,8),x2,y2+1,2,RGB(150,50,0)); END; 
    IF d3≤1.2 THEN M9(10,9):=M9(10,9)+Inj;
     IF Shield3≥Inj THEN Shield3:=Shield3-Inj; ELSE Lp3:=Lp3+Shield3-Inj; Shield3:=0; END;
     TEXTOUT(M9(10,9),x3,y3+1,2,RGB(150,50,0)); END;
   END;
   xp:=M9(10,1); yp:=M9(10,2); Inj:=35;
        IF Z=6 THEN Sua:=0; M9(10,4):=1; Z:=0; 20?d1?d2?d3; BREAK; END;
   END;
  WAIT(0.002);
  END;  //LOOP
 END;
END;

IF ISKEYDOWN(30) OR K=30 THEN
   IF M=-9.9 AND M9(6,21)≠0 THEN Ref1:=1; Ref2:=1; Ref3:=1; END;
   IF M9(10,3)>0 THEN (ROUND(x1,1)-M9(10,1))*ROUND(y1,1)?M9(5,4);  (ROUND(x2,1)-M9(10,1))*ROUND(y2,1)?M9(5,5); (ROUND(x3,1)-M9(10,1))*ROUND(y3,1)?M9(5,6); END;
   IF Skill=-1 OR Skill=-2 THEN IF Skill=-2 THEN M9(5,13):=Skill; END; 1?Bomb?R; 99?xp?yp; END;
IF M9(5,13)≠-2 THEN
BLIT(G1);
TEXTOUT("我",x1,y1,3,RGB(150,230,180));
TEXTOUT("你",x2,y2,3,RGB(50,150,255));
TEXTOUT("他",x3,y3,3,RGB(200,160,180));
END;
   IF Dir≠1 AND Dir≠-1 THEN Dir:=1; END;
 IF Skill=9 OR Skill=22 THEN vx:=Dir*v0*COS(θ); vy:=v0*SIN(θ); T:=0; X:=x0; Y:=y0; WAIT(.22); END;
IF (Skill≠0 AND times=0) OR (Skill=21 AND FP(times/3)=0 AND times≠9) THEN
Skill?M9(5,13);
IF Skill=7 OR Skill=18 THEN x0?M9(5,14); y0?M9(5,15); END;
 IF Skill=2 OR Skill=4 OR Skill=5 OR Skill=6 OR Skill=9 OR Skill=10 OR Skill=12 OR (14≤Skill AND Skill≤18) OR Skill=21 OR Skill=22 THEN 1?Rep;
       IF Skill≠6 AND Skill≠9 AND Skill≠15 AND Skill≠14 AND Skill≠7 AND Skill≠16 AND Skill≠21 AND Skill≠22 THEN 0?x0; 0?y0; WAIT(0.3); ELSE IF T=0 THEN X:=x0; Y:=y0; ax:=Dir; 0?Bomb; 1?Rep; END; END;
     IF Skill=16 OR Skill=21 THEN
       IF times≥1 THEN x0:=M9(5,14)-.6; y0:=M9(5,15)+.6; END;
       x0:=x0+.6; X:=x0+.6+Dir*5; Rep:=-1; Y:=y0+0.05;
         IF Skill=21 THEN Inj:=63; K:=0; Y:=y0-.6+0.05; y0:=y0-.6; END;
     θ:=ATAN(Dir*(Y-y0)/(X-x0));
     LINE(X-.4,Y,X+.4,Y,RGB(0,255,200)); LINE(X,Y+.4,X,Y-.4,RGB(0,255,200)); ARC(X,Y,6,RGB(0,0,0));
     WAIT(0.25);
     END; // 16/21
     IF Skill=22 THEN Tset:=7.55; A:=5; T:=0; TEXTOUT("延迟: 5"+"秒",-13.9,10.9,3,RGB(255,0,0),200,RGB(255,255,255)); WAIT(0.2); END;
 0?Bomb; IF Skill=15 OR Skill=6 THEN WAIT(0.3); END;
 REPEAT
  IF Skill≠6 AND Skill≠9 AND Skill≠15 AND Skill≠14 AND Skill≠16 AND Skill≠21 AND Skill≠22 THEN
  IF MOUSE(0)≠-1 AND MOUSE(1)≠-1 THEN MOUSE(0)/10-16?x0; 10.9-MOUSE(1)/11?y0; BLIT(G1); END;
   IF ISKEYDOWN(7) AND x0≥-16 THEN  x0:=x0-0.1; BLIT(G1); END; 
   IF ISKEYDOWN(8) AND x0≤16 THEN  x0:=x0+0.1; BLIT(G1); END;
   IF ISKEYDOWN(2) AND y0≤11 THEN  y0:=y0+0.1; BLIT(G1); END;
   IF ISKEYDOWN(12) AND y0≥-13 THEN y0:=y0-0.1; BLIT(G1); END;
  END;
  
  IF Skill=15 THEN
   IF ISKEYDOWN(7) AND X≥x0-2 THEN  X-0.1?X?M9(10,1); BLIT(G1); END; 
   IF ISKEYDOWN(8) AND X≤x0+3 THEN  X+0.1?X?M9(10,1); BLIT(G1); END;
   IF ISKEYDOWN(2) AND Y≤y0+2 THEN  Y+0.1?Y?M9(10,2); BLIT(G1); END;
   IF ISKEYDOWN(12) AND Y≥y0-3 THEN Y-0.1?Y?M9(10,2); BLIT(G1); END;
  END;
IF Skill=16 OR Skill=21 THEN
 IF Skill=21 THEN I:=Inj;
     IF ISKEYDOWN(50) THEN
      IF Play=1 AND Shield1≥100 THEN Shield1:=Shield1-100; Inj:=Inj+40; END;
      IF Play=2 AND Shield2≥100 THEN Shield2:=Shield2-100; Inj:=Inj+40; END;
      IF Play=3 AND Shield3≥100 THEN Shield3:=Shield3-100; Inj:=Inj+40; END;
      RECT(-15.6,11,5,9.5);
      TEXTOUT(IP((Inj-63)/40)+"次为枪充能,伤害： "+Inj,-15.6,11,2,RGB(160,180,255));
      WAIT(0.2);
     END;
     IF ISKEYDOWN(45) THEN
      IF Play=1 AND Inj>63 THEN Shield1:=Shield1+100; Inj:=Inj-40; END;
      IF Play=2 AND Inj>63 THEN Shield2:=Shield2+100; Inj:=Inj-40; END;
      IF Play=3 AND Inj>63 THEN Shield3:=Shield3+100; Inj:=Inj-40; END;
      RECT(-15.6,11,5,9.5);
      TEXTOUT(IP((Inj-63)/40)+"次为枪充能,伤害： "+Inj,-15.6,11,2,RGB(160,180,255));
      WAIT(0.2);
     END;
  END;
   IF ISKEYDOWN(2) OR ISKEYDOWN(12) OR ISKEYDOWN(40) THEN
   BLIT(G1);
     IF ISKEYDOWN(2) AND Y≤y0+4.95 THEN Y:=Y+.1; END;
     IF ISKEYDOWN(12) AND Y≥y0-4.95 THEN Y:=Y-.1; END; 
   IF Y≥y0+5 OR Y≤y0-5 THEN Y:=y0+0.05; Dir:=-Dir; END;
   IF ISKEYDOWN(40) THEN Dir:=-Dir; WAIT(0.2); END;
  X:=x0+Dir*√(5^2-(Y-y0)^2);
  LINE(X-.4,Y,X+.4,Y,RGB(0,255,200)); LINE(X,Y+.4,X,Y-.4,RGB(0,255,200)); ARC(X,Y,6,RGB(0,0,0));
   IF ABS(Y-y0)≤4.2 THEN WAIT(0.03); ELSE WAIT(0.07); END;
  θ:=ATAN(Dir*(Y-y0)/(X-x0));
   LINE(x0,y0,X,Y);
  END;
END;  //  21//16

 IF Skill=9 OR Skill=22 THEN
     IF ISKEYDOWN(30)=1 THEN Rep:=-1; ELSE Rep:=1; END;
   IF Skill=22 AND ISKEYDOWN(41) THEN A:=A-1;
    IF A≤0 THEN A:=5; END;
    IF A=1 THEN Tset:=1.2; END;
    IF A=2 THEN Tset:=2.55; END;
    IF A=3 THEN Tset:=4.55; END;
    IF A=4 THEN Tset:=6; END;
    IF A=5 THEN Tset:=7.55; END;
    TEXTOUT("延迟: "+A+"秒",-13.9,10.9,3,RGB(255,0,0),200,RGB(255,255,255));
    WAIT(0.2);
   END;
  IF ISKEYDOWN(2) OR ISKEYDOWN(12) OR ISKEYDOWN(50) OR ISKEYDOWN(45) OR ISKEYDOWN(40) THEN
   IF ISKEYDOWN(2) THEN θ:=θ+1; END; IF ISKEYDOWN(12) THEN θ:=θ-1; END;
   IF θ>80 OR θ<-60 THEN θ:=45; END;
   IF ISKEYDOWN(50) AND v0<24 THEN v0:=v0+1; END; IF ISKEYDOWN(45) AND v0>5 THEN v0:=v0-1; END;
   IF ISKEYDOWN(40) THEN Dir:=-Dir; WAIT(.2); END;
  X:=x0; Y:=y0; T:=0; BLIT(G1); vx:=Dir*v0*COS(θ); vy:=v0*SIN(θ);
  RECT(-16,11,-13.5,10.5); TEXTOUT(θ,-15.8,11,3,RGB(120,120,120));
  WAIT(.02);
  END;   //down key
   IF Y>-16 THEN T:=T+0.2;
   X:=x0+vx*T; Y:=y0+.5+vy*T-5*T^2;
   ARC(X,Y,2);
    IF Skill=22 AND T≥1.5 THEN Y:=-17; END;
   END;
 END;
 IF Skill=2 OR Skill=10 THEN
   ARC(x0+0.5,y0-0.5,10);
  IF GETPIX(x0+.5,y0-.5)≠Black AND GETPIX(x0+.5,y0-1.3)≠Black THEN -1?Rep; ELSE Rep:=1; END;
 END;
 IF Skill=4 THEN Rep:=-1;
  IF ISKEYDOWN(40) THEN Dir:=-Dir; WAIT(0.2); END;
   IF Dir=-1 THEN
    TEXTOUT("???",x0-3.5,y0,3,RGB(200,180,255));
   ELSE 
    TEXTOUT("???",x0,y0,3,RGB(200,180,255)); 
   END;
 END;
 IF Skill=5 OR Skill=17 THEN
  Rep:=-1;
  TEXTOUT("?",x0-.5,y0,3,RGB(200,180,255));
 END;
 IF Skill=6 OR Skill=14 THEN
WAIT(0.01);
IF Skill=6 THEN Rep:=-1; T+0.01?T;
 IF T≥5 THEN TEXTOUT(TRUNCATE(8-T,1),X-.1,Y+1.1,2,RGB(50,80,255),100,RGB(255,255,255)); END;
 IF T=8 THEN K:=30; END;
IF FP(T/0.2)=0 THEN IP(RANDOM(-2,1))?ax; END;
ELSE  // SKILL 14
T:=T+0.01;
distance({X,Y},{x1+.5,y1-.5})?d1;
distance({X,Y},{x2+.5,y2-.5})?d2;
distance({X,Y},{x3+.5,y3-.5})?d3;
IF T≥0.2 AND (d1≤1.3 OR d2≤1.3 OR d3≤1.3) THEN
Dir:=-ax; TRUNCATE(RANDOM(72,76),1)?θ; TRUNCATE(RANDOM(6,8),1)?v0;
 1?Bomb; xp:=X+.5; yp:=Y-.5; Inj:=200; R:=1; a:=0; Rep:=-1; r:=2.1; T:=T+1;
 M9(13,13):=x1; M9(13,14):=y1; M9(13,15):=x2; M9(13,16):=y2; M9(13,17):=x3; M9(13,18):=y3;//插个眼
END;
 IF T≥3 OR X≤-16.5 OR X≥16.5 THEN T:=10; Break; ELSE 
  TEXTOUT("时间: "+T,-15.6,10.9,3,RGB(255,50,50),200,RGB(255,255,255)); END;
 END;
  IF GETPIX(X+0.2,Y-1.4)≠Black AND GETPIX(X+1,Y-1.4)≠Black THEN
  Y-0.1?Y;
  END;
IF ax=-1 THEN
      IF GETPIX(X-0.2,Y-0.4)≠Black THEN X-0.1?X;
        IF X≤-16.5 OR X≥16.5 OR Y≤-16 THEN T:=10; 0?Bomb; -1?Rep; END;
      ELSE
 IF Skill=14 THEN
  1?Bomb; xp:=X+.6; yp:=Y-.6; Inj:=120; R:=1; a:=0; Rep:=-1; r:=2; T:=T+0.5;
  END; END;
ELSE
      IF GETPIX(X+1.5,Y-0.4)≠Black THEN X+0.1?X;
        IF X≤-16.5 OR X≥16.5 OR Y≤-16 THEN T:=10; -1?Rep; 0?Bomb; END;
      ELSE
 IF Skill=14 THEN 
  1?Bomb; xp:=X+.6; yp:=Y-.6; Inj:=120; R:=1; a:=0; Rep:=-1; r:=2; T:=T+0.5;
  END; END;
END;
IF GETPIX(X+1.3,Y-1.4)=Black OR GETPIX(X+.2,Y-1.4)=Black THEN Y+0.2?Y; END; 
 RECT(X,Y-0.3,X+1.3,Y-1.2);
 IF Skill=6 THEN TEXTOUT("羊",X,Y,3,RGB(255,50,50));
  ELSE TEXTOUT("牛",X,Y,3,RGB(200,100,50));
 END;
END;   // 6/14
IF Skill=12 THEN
  Rep:=-1;
  TEXTOUT("↓↓↓↓↓↓↓↓↓↓↓↓",x0-4.5,y0,3,RGB(200,180,255));
END;
IF Skill=15 THEN
  M9(10,3):=500; M9(10,1):=X; M9(10,2):=Y; M9(10,6):=0;
    IF GETPIX(X+.2,Y-.2)≠Black THEN -1?Rep; ELSE Rep:=1; END;
   ARC(X,Y,8); 
END;
IF Skill=18 THEN X:=x0; Y:=y0; Rep:=-1;
LINE(x0-.5,y0,x0+.5,y0,RGB(255,130,130));LINE(x0,y0-.5,x0,y0+.5,RGB(255,130,130));
END;
   TEXTOUT("我",x1,y1,3,RGB(150,230,180));
   TEXTOUT("你",x2,y2,3,RGB(50,150,255));
   TEXTOUT("他",x3,y3,3,RGB(200,160,180)); 
   TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(100,255,200));
   TEXTOUT("枪",M9(10,1)-0.5,M9(10,2)+0.5,1,RGB(255,200,100));
   WAIT(0.01);
  UNTIL (ISKEYDOWN(30)=1 OR Skill=14 OR K=30) AND Rep=-1
  END;
//   ................   //
  IF Skill=2 OR Skill=10 THEN 
    IF Play=1 THEN x1:=x0; y1:=y0; END;
    IF Play=2 THEN x2:=x0; y2:=y0; END;
    IF Play=3 THEN x3:=x0; y3:=y0; END;
  END; 
  IF Skill=10 THEN TEXTOUT("大平台",G1,x0-1.8,y0-1.6,4,RGB(150,0,150),200,RGB(255,200,200)); END;
  IF Skill=4 THEN
   vx:=2; vy:=1.2; Y:=y0+20; ax:=.8; ay:=.4; 1?t; Rep:=1;
   X:=x0-30*Dir;
  END;
  IF Skill=5 OR Skill=17 THEN Rep:=1; Y:=12; X:=x0+0.1; END;
  IF Skill=12 THEN Rep:=1; X:=x0; y0:=12; 1?Bomb; θ:=-90; v0:=50; Inj:=85; r:=-8; R:=0; a:=0; END;
  IF Skill=6 THEN Rep:=1; 1?Bomb; R:=0; v0:=0.2; θ:=90; END;
END;  //Skill  2/4/5/6/17/18

M9(13,19):=0; M9(13,20):=0; M9(13,21):=0;

CASE
IF Skill=-1 THEN  
 IF Play=1 THEN AFlue1:=AFlue1+3; Poi1:=Poi1+1; TEXTOUT("+3",x1,y1+1,2,RGB(250,200,200)); END;
 IF Play=2 THEN AFlue2:=AFlue2+3; Poi2:=Poi2+1; TEXTOUT("+3",x2,y2+1,2,RGB(250,200,200)); END;
 IF Play=3 THEN AFlue3:=AFlue3+3; Poi3:=Poi3+1; TEXTOUT("+3",x3,y3+1,2,RGB(250,200,200)); END;
 WAIT(0.25);
END;
IF Skill=1 THEN Inj:=250; r:=0; END;
IF Skill=13 THEN Bomb:=0;
 IF Play=1 THEN Ref1:=1; END;
 IF Play=2 THEN Ref2:=1; END;
 IF Play=3 THEN Ref3:=1; END;
END;
IF Skill=14 THEN
 M9(13,13):=x1; M9(13,14):=y1;
 M9(13,15):=x2; M9(13,16):=y2;
 M9(13,17):=x3; M9(13,18):=y3;
END;
  IF Skill=16 THEN Inj:=250; r:=1; v0:=40; x0:=x0+.5; Bomb:=1; R:=0; END;
  IF Skill=17 THEN Inj:=380; r:=2; a:=0; t:=0; END;
  IF Skill=18 THEN Inj:=420; r:=0; M9(5,14)?x0; M9(5,15)?y0; Bomb:=1; R:=0; END;
  IF Skill=21 THEN r:=-6.5; v0:=12; END;
IF Skill=20 THEN 0?R?Bomb; RECT(G1,x0+.7+Dir,y0+3,x0+.7+Dir*3,y0-4.4,RGB(255,200,200)); END;
IF Skill=9 THEN A:=9; Inj:=250;
 IF Play=1 THEN d1:=0; 20?d2?d3; M9(13,13):=x1; M9(13,14):=y1; END;
 IF Play=2 THEN d2:=0; 20?d1?d3; M9(13,15):=x2; M9(13,16):=y2; END;
 IF Play=3 THEN d3:=0; 20?d2?d1; M9(13,17):=x3; M9(13,18):=y3; END;
END;  //9
IF Skill=11 THEN v0:=10; θ:=80; A:=0; Bomb:=0;
20?d1?d2?d3;
 IF Play≠1 THEN M9(13,13):=x1; M9(13,14):=y1; d1:=√((x1-x0)^2+(y1-y0)^2); END;
 IF Play≠2 THEN M9(13,15):=x2; M9(13,16):=y2; d2:=√((x2-x0)^2+(y2-y0)^2); END;
 IF Play≠3 THEN M9(13,17):=x3; M9(13,18):=y3; d3:=√((x3-x0)^2+(y3-y0)^2); END;
END;  // 11
IF Skill=3 THEN Inj:=300; a:=0; r:=1.5; END;
IF Skill=7 THEN a:=0; r:=0; END;
IF Skill=8 THEN  Bomb:=0;
 IF Play=1 THEN Shield1:=Shield1+300; TEXTOUT("+300",x1,y1+1,1,RGB(50,80,250)); END;
 IF Play=2 THEN Shield2:=Shield2+300; TEXTOUT("+300",x2,y2+1,1,RGB(50,80,250)); END;
 IF Play=3 THEN Shield3:=Shield3+300; TEXTOUT("+300",x3,y3+1,1,RGB(50,80,250)); END;
 WAIT(0.2);
END;
IF Skill=12 THEN Inj:=85; r:=-8; END;
IF Skill=19 THEN Inj:=200; M9(5,16):=Inj; r:=1; END;
END;  //Case

IF r=2.1 THEN R:=-1; x0:=xp; y0:=yp; END;
IF Skill=9 OR Skill=11 OR Skill=14 THEN
  IF d1>1.5 THEN M9(13,19):=1; END;
  IF d2>1.5 THEN M9(13,20):=1; END;
  IF d3>1.5 THEN M9(13,21):=1; END;
  IF V≠3.33 THEN
    M9(13,1):=v0*COS(θ);M9(13,2):=v0*SIN(θ);
    M9(13,5):=v0*COS(θ);M9(13,6):=v0*SIN(θ);
    M9(13,9):=v0*COS(θ);M9(13,10):=v0*SIN(θ);
  END;
 M9(13,3):=0;M9(13,7):=0;M9(13,11):=0;
 M9(13,4):=0;M9(13,8):=0;M9(13,12):=0;
 IF d1>1.5 AND d2>1.5 AND d3>1.5 THEN R:=1; END;
 REPEAT
 IF d1≤1.5 AND y1>-16 AND M9(13,19)=0 THEN 
  M9(13,3):=M9(13,3)+0.01; M9(13,4):=M9(13,4)+0.01;
  y1:=M9(13,14)+0.5+M9(13,2)*M9(13,4)-5*M9(13,4)^2;
  IF (y1≥y0+0.49+M9(13,2)^2/22 OR GETPIX(x1+.7,y1+.1)=Black) AND A=9 THEN Inj:=Inj*6*(y1-y0)/96+M9(13,1)^2+M9(13,2)^2; TRUNCATE(Inj,2)?Inj; A:=0; END;
  x1:=M9(13,13)+Dir*M9(13,1)*M9(13,3);
    IF GETPIX(x1+1.4,y1-.7)=Black OR GETPIX(x1-.1,y1-.7)=Black THEN -ABS(.5*M9(13,1))?M9(13,1); M9(13,13):=x1; M9(13,3):=0; END;
    IF GETPIX(x1+.7,y1+.1)=Black THEN -ABS(.8*M9(13,2))?M9(13,2); M9(13,14):=y1-.5; M9(13,4):=0; END;
  IF GETPIX(x1+1,y1-1.6)=Black OR y1<-16 OR GETPIX(x1+.3,y1-1.6)=Black THEN 
  1?M9(13,19);
   IF Skill=9 THEN xp:=x1+0.7; yp:=y1-0.7; END;
  END;
 TEXTOUT("我",x1,y1,3,RGB(150,230,180),100,RGB(255,255,255));
 END;
 IF d2≤1.5 AND y2>-16 AND M9(13,20)=0 THEN
  M9(13,7):=M9(13,7)+0.01; M9(13,8):=M9(13,8)+0.01;
  y2:=M9(13,16)+0.5+M9(13,6)*M9(13,8)-5*M9(13,8)^2;
  IF (y2≥y0+0.49+M9(13,6)^2/22 OR GETPIX(x2+.7,y2+.1)=Black) AND A=9 THEN Inj:=Inj*6*(y2-y0)/96+M9(13,5)^2+M9(13,6)^2; TRUNCATE(Inj,2)?Inj; A:=0; END;
  x2:=M9(13,15)+Dir*M9(13,5)*M9(13,7);
    IF GETPIX(x2+1.4,y2-.7)=Black OR GETPIX(x2-.1,y2-.7)=Black THEN -ABS(.5*M9(13,5))?M9(13,5); M9(13,15):=x2; M9(13,7):=0; END;
    IF GETPIX(x2+.7,y2+.1)=Black THEN -ABS(.8*M9(13,6))?M9(13,6); M9(13,16):=y2-.5; M9(13,8):=0; END;
  IF GETPIX(x2+1,y2-1.6)=Black OR y2<-16 OR GETPIX(x2+.3,y2-1.6)=Black THEN 
  1?M9(13,20);
    IF Skill=9 THEN xp:=x2+.7; yp:=y2-.7; END;
  END;
 TEXTOUT("你",x2,y2,3,RGB(50,150,255),100,RGB(255,255,255)); 
 END; 
 IF d3≤1.5 AND y3>-16 AND M9(13,21)=0 THEN
  M9(13,11):=M9(13,11)+0.01; M9(13,12):=M9(13,12)+0.01;
  y3:=M9(13,18)+0.5+M9(13,10)*M9(13,12)-5*M9(13,12)^2;
  IF (y3≥y0+0.49+M9(13,10)^2/22 OR GETPIX(x3+.7,y3+.1)=Black) AND A=9 THEN Inj:=Inj*6*(y3-y0)/96+M9(13,9)^2+M9(13,10)^2; TRUNCATE(Inj,2)?Inj; A:=0; END;
  x3:=M9(13,17)+Dir*M9(13,9)*M9(13,11);
    IF GETPIX(x3+1.4,y3-.7)=Black OR GETPIX(x3-.1,y3-.7)=Black THEN -ABS(.5*M9(13,9))?M9(13,9); M9(13,17):=x3; M9(13,11):=0; END;
    IF GETPIX(x3+.7,y3+.1)=Black THEN -ABS(.8*M9(13,10))?M9(13,10); M9(13,18):=y3-.5; M9(13,12):=0; END;
  IF GETPIX(x3+1,y3-1.6)=Black OR y3<-16 OR GETPIX(x3+.3,y3-1.6)=Black THEN 
  1?M9(13,21);
   IF Skill=9 THEN xp:=x3+.7; yp:=y3-.7; END;
  END;
  TEXTOUT("他",x3,y3,3,RGB(200,160,180),100,RGB(255,255,255)); 
 END;
 UNTIL M9(13,19)=1 AND M9(13,20)=1 AND M9(13,21)=1 END;
     //TEXTOUT([Inj],-15.6,5,3,RGB(255,50,50),200,RGB(255,255,255)); WAIT;
 IF d1≤1.5 THEN M9(4,1):=M9(4,1)+200; M9(4,Play+1):=M9(4,Play+1)+200; M9(4,5):=M9(4,5)+200; Lp1:=Lp1-200; TEXTOUT("200",x1,y1+1,2,RGB(150,50,0));WAIT(0.05); END;
 IF d2≤1.5 THEN M9(4,1):=M9(4,1)+200; M9(4,Play+1):=M9(4,Play+1)+200; M9(4,6):=M9(4,6)+200; Lp2:=Lp2-200; TEXTOUT("200",x2,y2+1,2,RGB(150,50,0));WAIT(0.05); END;
 IF d3≤1.5 THEN M9(4,1):=M9(4,1)+200; M9(4,Play+1):=M9(4,Play+1)+200; M9(4,7):=M9(4,7)+200; Lp3:=Lp3-200; TEXTOUT("200",x3,y3+1,2,RGB(150,50,0));WAIT(0.05); END;
IF Skill=9 THEN 1?Bomb?R; r:=3.1; Rep:=-1; END;
END; //  9/11
 IF Skill=4 OR Skill=5 OR Skill=6 OR Skill=17 THEN
   REPEAT
  IF Skill=4 THEN  WAIT(0.01);t:=t+0.01;
   RECT(X,Y,X+3,Y-1.5);
   IF t≥1.2 THEN ay:=ay+.2; ax:=ax-.3; END;
   IF t=1.5 THEN Rep:=-1 END;
    X:=X+Dir*vx*t-Dir*ax*t^2;
    Y:=Y-vy*t+ay*t^2;
   IF t=1.2 THEN ay:=ay*2; 1?Bomb; θ:=-30; v0:=20; x0:=X+2*Dir; y0:=Y-2; Inj:=450; r:=2; R:=0; a:=0; END;
     IF GETPIX(X,Y-.7)=Black OR GETPIX(X+1.4,Y+.2)=Black OR GETPIX(X+3,Y-.7)=Black THEN
     1?Bomb?R; xp:=X+1.3; yp:=Y-.7; Inj:=550; r:=r+3; Rep:=-1; Z:=0;
      WHILE Z≤20 DO Z:=Z+1;
      LINE(xp,yp,xp+TRUNCATE(RANDOM(-4,4),1),yp+TRUNCATE(RANDOM(-4,4),1),RGB(255,50,0));
      END;
     WAIT(0.05);
     END;
   TEXTOUT("战姫",X,Y,3,RGB(150,140,255));
  END;                    //4
  IF Skill=5 THEN
   TEXTOUT("天姫",X-1.3,11,3,RGB(210,100,255));
    IF GETPIX(X,Y-1.7)≠Black THEN  Y:=Y-0.3;
     RECT(X-0.2,10.7,X+0.2,Y,RGB(220,200,255),RGB(255,255,255));
     ELSE  WAIT(0.01);t:=t+0.1;
        RECT(X-t,10.7,X+t,Y-1.3,RGB(220,200,255),RGB(IP(220+t*23),IP(100+t*100),IP(200+36*t)));
        IF t=1.5 THEN 1?Bomb?R; xp:=X; yp:=Y-.8; Inj:=1000; r:=7; Rep:=-1; a:=0; END; 
    END;
    IF Y≤-16 THEN Rep:=-1; Bomb:=0; END;
  END;    //5
  IF Skill=17 THEN
    IF GETPIX(X,Y-1.3)=Black THEN t:=t+0.1; END;
       IF (ABS(X-x1-.5)≤.82 AND ABS(Y-y1+.5)≤.82 AND Lp1>0) OR (ABS(X-x2-.5)≤.82 AND ABS(Y-y2+.5)≤.82 AND Lp2>0) OR t≥6.5 OR Y≤-17
       OR (ABS(X-x3-.5)≤.82 AND ABS(Y-y3+.5)≤.82 AND Lp3>0) OR (ABS(X-M9(10,1))≤.7 AND ABS(Y-M9(10,2))≤.7)
       THEN Rep:=-1; 1?Bomb?R; xp:=X; yp:=Y;
        ELSE Y:=Y-0.1; END;
    RECT(G1,X-.4,Y+.5,X+.5,Y-.4);
    RECT(X-.4,Y+.5,X+.5,Y-.4);
    TEXTOUT("钻",X-.4,Y+.4,1,RGB(170,140,0)); 
  END;
  IF Skill=6 THEN
  WAIT(0.01);  t:=t+0.01;
   IF ISKEYDOWN(2) OR ISKEYDOWN(7)  THEN θ:=θ+4; END;
   IF ISKEYDOWN(12) OR ISKEYDOWN(8) THEN θ:=θ-4; END;
   IF θ>360 THEN θ:=0; END; IF θ<0 THEN θ:=360; END;
     ax:=COS(θ)*v0; ay:=SIN(θ)*v0;
     X:=X+ax; Y:=Y+ay;
   IF GETPIX(X-.1,Y+.1)=Black OR GETPIX(X+1.3,Y-1.4)=Black OR GETPIX(X+1.3,Y+.1)=Black OR GETPIX(X-.1,Y-1.4)=Black THEN Bomb:=1; xp:=X; yp:=Y; Inj:=850; r:=5; 1?Bomb?R; Rep:=-1; a:=0; END;
   IF Y≤-17 OR Y≥17 OR X≤-18 OR X≥18 OR t=8 THEN Rep:=-1; 0?R?Bomb; END;
       //TEXTOUT("时间: "+t,-15.6,2,3,RGB(255,50,50),200,RGB(255,255,255));
        IF t≥5 THEN TEXTOUT(TRUNCATE(8-t,1),X-.1,Y+1,2,RGB(50,80,255),100,RGB(255,255,255)); END;
       TEXTOUT("羊",X,Y,3,RGB(255,50,50),200,RGB(255,255,255));
   END;  //6
   UNTIL Rep=-1 END;
 END;     //4 5 6
 IF Skill=22 THEN 0?tx?ty?T; Inj:=400; r:=1.6; vx:=Dir*COS(θ)*v0; vy:=SIN(θ)*v0; y0:=y0+1.5;
 REPEAT
  tx:=tx+0.015; ty:=ty+0.015; T:=T+0.01;
  TEXTOUT(".",X,Y-0.5,1,RGB(255,255,255));
  IF xp≠X AND yp≠Y AND ROUND(θ,0)≠270 THEN
   θ:=ASIN( (Y-yp)/distance({xp,yp},{X,Y}) );
   IF X<xp THEN θ:=180-θ; Dir:=-1; ELSE Dir:=1; IF Y≤yp THEN θ:=360+θ; END; END;
   xp:=X; yp:=Y;
  END;
   IF 0.001≤ABS(vx) AND 0.001≤ABS(vy) THEN X:=x0+vx*tx; Y:=y0+vy*ty-5*ty^2; END;
  p2:=GETPIX(X+0.15,Y-0.9); p4:=GETPIX(X+0.4,Y-1.15);
  p6:=GETPIX(X+0.15,Y-1.4); p8:=GETPIX(X-0.1,Y-1.15);
  IF Lp1>0 THEN d1:=distance({X+.2,Y-1.15},{x1+0.75,y1-0.75}); END;
  IF Lp2>0 THEN d2:=distance({X+.2,Y-1.15},{x2+0.75,y2-0.75}); END;
  IF Lp3>0 THEN d3:=distance({X+.2,Y-1.15},{x3+0.75,y3-0.75}); END;
    IF p8=Black OR p6=Black OR p4=Black OR p2=Black
     OR (T≥0.5 AND ((Ref1=1 AND d1≤1.5) OR (Ref2=1 AND d2≤1.5) OR (Ref3=1 AND d3≤1.5))) THEN
     IF T≥0.5 AND ((Ref1=1 AND d1≤1.5) OR (Ref2=1 AND d2≤1.5) OR (Ref3=1 AND d3≤1.5)) THEN
      vx:=-vx; vy:=ABS(vy);vx:=TRUNCATE(RANDOM(-3,3),2)+vx;vy:=TRUNCATE(RANDOM(1,4),2)+vy;
     END;
     tx:=0; ty:=0; x0:=X; y0:=Y;
    IF p6≠Black AND ABS(vx)≤0.2 THEN IF -0.2≤vx THEN vx:=-0.18;END; IF vx≤0.2 THEN vx:=0.18;END; END;
    IF p8=Black OR p4=Black THEN
     IF (45≤θ AND θ≤135) OR (225≤θ AND θ≤315) THEN
     vx:=-0.9*vx; ELSE vx:=-0.95*Dir*COS(θ)*vx; END;
    END;
    IF p6=Black THEN vx:=vx*0.97; vy:=0.85*ABS(vy); END;
    IF p2=Black THEN vy:=-0.9*ABS(vy); END;
    END;
  TEXTOUT(".",X,Y-0.5,1,RGB(60,235,55));
  UNTIL Y≤-14 OR T≥Tset OR 18≤ABS(X) END;
  1?Bomb?R; xp:=X; yp:=Y-1;
  //Tset:1.2?1s;2.55?2s;4.55?3s;6?4s;7.55?5s;
 END;  //37
M9(5,16):=Inj; M9(5,21):=r;
END;  //Skill X

IF (Skill=0 OR Skill=8 OR Skill=13) AND times=0 AND r=0 AND v0≤25 THEN Inj:=125; M9(5,16):=Inj; M9(5,21):=r; END;
IF (Play=1 AND Move1≠0) OR (Play=2 AND Move2≠0) OR (Play=3 AND Move3≠0) THEN IF r≠-.3 THEN Inj:=Inj*.8; END; END;

IF M9(5,13)≠-2 OR Cost=-1 THEN
BLIT(G1);
TEXTOUT("我",x1,y1,3,RGB(150,230,180));
TEXTOUT("你",x2,y2,3,RGB(50,150,255));
TEXTOUT("他",x3,y3,3,RGB(200,160,180));
TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(100,255,200));
TEXTOUT("枪",M9(10,1)-0.5,M9(10,2)+0.5,1,RGB(255,200,100));
TEXTOUT(IP(Lp1/48)+"%",-6.3,6.8,2,RGB(150,230,180));
TEXTOUT(IP(Lp2/48)+"%",-6.3,5.8,2,RGB(50,150,255));
IF Players=3 THEN TEXTOUT(IP(Lp3/48)+"%",-6.3,4.8,2,RGB(200,160,180)); END;
END;
IF v0=42 THEN TEXTOUT("轰炸中...正在: "+times,-15.6,8,3,RGB(255,50,120),400,RGB(255,255,255)); END;

0?t;
IF times≥1 AND Skill≠0 AND v0≠42 THEN Inj:=M9(5,16); r:=M9(5,21); END;

IF Bomb=1 THEN
     IF V≠3.33 AND Skill≠14 THEN
     vx:=v0*COS(θ); vy:=v0*SIN(θ);
     END;
WHILE R=0 DO
IF Skill≠16 AND Skill≠21 AND T≠99 THEN
 t:=t+0.01;
 yp:=y0+.2+vy*t-5*t^2;
 xp:=x0+.5+Dir*vx*t+a*t^2;
 IF Skill=18 AND t=1 THEN T:=99;
   IF xp≥X THEN Dir:=-1 ELSE Dir:=1; END;
   x0:=xp; y0:=yp;
   θ:=IP(ATAN(Dir*(Y-y0)/(X-x0))); 
   vx:=30*COS(θ); vy:=30*SIN(θ); t:=0;
 END;
ELSE
   t:=t+0.01;
   xp:=x0+Dir*vx*t; yp:=y0+vy*t;
   IF FP(t/.1)=0 AND Skill=21 THEN
    LINE(M9(7,20),M9(7,21),xp,yp,RGB(50,200,255));
     IF t≥.2 THEN LINE(x0+Dir*vx*(t-.2),y0+vy*(t-.2),x0+Dir*vx*(t-.1),y0+vy*(t-.1),RGB(255,255,255)); END;
    M9(7,20):=xp; M9(7,21):=yp;
   END; 
   IF xp≤-20 OR xp≥20 OR yp≥16 OR yp≤-19 THEN R:=1; END;
END;
IF Skill≠21 THEN
 IF GETPIX(xp-.6,yp+.6)=Black OR GETPIX(xp+.6,yp+.6)=Black OR yp<-16 OR GETPIX(xp-.6,yp-.6)=Black OR GETPIX(xp+.6,yp-.6)=Black THEN    //找到一个翻代码的!...记得点赞,点赞或者投币
 1?R;
 END;
ELSE
 IF GETPIX(xp,yp)=Black THEN R:=1; END;
END;
   IF t≥0.2 THEN
 IF (ABS(xp-x1-.5)≤.82 AND ABS(yp-y1+.5)≤.82 AND Lp1>0) OR (ABS(xp-x2-.5)≤.82 AND ABS(yp-y2+.5)≤.82 AND Lp2>0)
 OR (ABS(xp-x3-.5)≤.82 AND ABS(yp-y3+.5)≤.82 AND Lp3>0) OR (ABS(xp-x9)≤.75 AND ABS(yp-y9)≤.75) OR (ABS(xp-M9(10,1))≤.7 AND ABS(yp-M9(10,2))≤.7)
  THEN R:=1; END; END;
IF Lp1>0 AND GETPIX(x1+.2,y1-1.4)≠Black AND GETPIX(x1+1,y1-1.4)≠Black THEN 
  RECT(x1,y1,x1+1.3,y1-1.2);
  y1-0.1?y1; IF Lp1>0 AND y1≤-16 THEN TEXTOUT("我 已重新复活!",-4.5,5,3,RGB(150,230,180),200,RGB(255,255,255)); Lp1:=TRUNCATE(Lp1/2,1); 13?y1; TRUNCATE(RANDOM(-15,15),2)?x1; END;
  TEXTOUT("我",x1,y1,3,RGB(150,230,180));
END;
IF Lp2>0 AND GETPIX(x2+.2,y2-1.4)≠Black AND GETPIX(x2+1,y2-1.4)≠Black THEN
  RECT(x2,y2,x2+1.3,y2-1.2);
  y2-0.1?y2; IF Lp2>0 AND y2≤-16 THEN TEXTOUT("你 已重新复活!",-4.5,5,3,RGB(50,150,255),200,RGB(255,255,255)); Lp2:=TRUNCATE(Lp2/2,1); 13?y2; TRUNCATE(RANDOM(-15,15),2)?x2; END;
  TEXTOUT("你",x2,y2,3,RGB(50,150,255));
END;
IF Lp3>0 AND Players=3 AND GETPIX(x3+.2,y3-1.4)≠Black AND GETPIX(x3+1,y3-1.4)≠Black THEN
  RECT(x3,y3,x3+1.3,y3-1.2);
  y3-0.1?y3; IF Lp3>0 AND y3≤-16 THEN TEXTOUT("他 已重新复活!",-4.5,5,3,RGB(200,160,180),200,RGB(255,255,255)); Lp3:=TRUNCATE(Lp3/2,1); 13?y3; TRUNCATE(RANDOM(-15,15),2)?x3; END;
  TEXTOUT("他",x3,y3,3,RGB(200,160,180));
END;
IF M9(10,3)>0 THEN
 IF GETPIX(M9(10,1)-.4,M9(10,2)-.7)≠Black AND GETPIX(M9(10,1)+.4,M9(10,2)-.7)≠Black THEN
   M9(10,2):=M9(10,2)-0.1;
   IF M9(10,2)≤-16 THEN M9(10,3):=0; -99?M9(10,1); -99?M9(10,2); END;
   TEXTOUT("枪",M9(10,1)-0.5,M9(10,2)+0.5,1,RGB(255,200,100),100,RGB(255,255,255));
 END;
END;
//TEXTOUT([t],-15.6,5,3,RGB(255,50,50),200,RGB(255,255,255)); WAIT(0.06);
 IF Skill≠21 THEN  
 TEXTOUT("炮",xp-.5,yp+.5,1,RGB(50,50,50),100,RGB(255,255,255)); 
 END;
 WAIT(0.0018);
END;  //WHILI LOOP
   //TEXTOUT([vx,vy],-15.6,5,3,RGB(255,50,50),200,RGB(255,255,255)); WAIT;
//  IF Skill=0 OR Skill=7 THEN
//  Xmax:=xp+15.9; Xmin:=xp-15.9; Ymax:=yp+10.9; Ymin:=yp-10.9;
//  RECT;  BLIT(G0,-15.9,10.9,G1);
//   TEXTOUT("我",x1,y1,3,RGB(150,230,180));
//   TEXTOUT("你",x2,y2,3,RGB(50,150,255));
//   TEXTOUT("他",x3,y3,3,RGB(200,160,180)); 
//   TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(100,255,200));
//  END;
//这里曾写有手榴弹的程序,后来我被计算器暴击破甲了

IF Skill=21 THEN Inj:=I; LINE(x0,y0,xp,yp,RGB(50,55,255)); END;

V:=0;
IF Skill=19 AND times=0 THEN M9(5,14):=xp; M9(5,15):=yp; END;
IF Skill=4 AND t>.8 THEN Inj:=500; END;
//TEXTOUT([x1,y1],-15.6,5,3,RGB(255,50,50),200,RGB(255,255,255)); WAIT;
IF Skill≠21 THEN ARC(xp,yp,15+r,{RGB(50,80,255),RGB(255,255,255)});
ELSE ARC(xp,yp,15+r,{RGB(255,255,255),RGB(255,255,255)}); END;
d1:=√((x1+.5-xp)^2+(y1-.6-yp)^2); M9(5,17):=d1;
d2:=√((x2+.5-xp)^2+(y2-.6-yp)^2); M9(5,18):=d2;
d3:=√((x3+.5-xp)^2+(y3-.6-yp)^2); M9(5,19):=d3;
d9:=√((x9+.5-xp)^2+(y9-.6-yp)^2);
M9(10,5):=√((M9(10,1)-xp)^2+(M9(10,2)-yp)^2);

IF Play=1 AND Skill=9 THEN d1:=20; M9(5,17):=20; END;
IF Play=2 AND Skill=9 THEN d2:=20; M9(5,18):=20; END;
IF Play=3 AND Skill=9 THEN d3:=20; M9(5,19):=20; END;

IF Ref1+Ref2+Ref3>0 AND r≠-.3 AND r≠6.1 AND (Skill≤3 OR (Skill=4 AND Inj≠550) OR Skill=7 OR Skill=8 OR Skill=13 OR Skill=19) AND v0≠42 THEN
 IF d1≤2.2+r/10 AND Ref1=1 THEN V:=3.33; Ref1:=0; END;
 IF d2≤2.2+r/10 AND Ref2=1 THEN V:=3.33; Ref2:=0; END;
 IF d3≤2.2+r/10 AND Ref3=1 THEN V:=3.33; Ref3:=0; END;
 IF V=3.33 THEN W:=3.33;
vx:=-vx; vy:=ABS(vy);
vx:=TRUNCATE(RANDOM(-8,8),2)+vx;
vy:=TRUNCATE(RANDOM(3,8),2)+vy;
IF times≥1 THEN W:=0; END;
  Skill:=0; R:=0; K:=30; x0:=xp; y0:=yp; CONTINUE 1; END;
END;//Bomb

IF Skill=7 THEN Inj:=TRUNCATE(distance({xp-x0},{yp-y0})*9,2); END;
//TEXTOUT([V],-15.6,5,3,RGB(255,50,50),200,RGB(255,255,255)); WAIT;

IF Skill=12 THEN
 IF Play=1 AND (d1≤2.2+r/10 OR d2≤2.2+r/10 OR d3≤2.2+r/10 OR M9(10,5)≤2+r/10) THEN S:=0;
  IF d1≤2.2+r/10 THEN Shield1:=Shield1+50; S:=S+50; END;
  IF d2≤2.2+r/10 THEN Shield1:=Shield1+50; S:=S+50; END;
  IF d3≤2.2+r/10 THEN Shield1:=Shield1+50; S:=S+50; END;
  IF M9(10,5)≤2+r/10 THEN Shield1:=Shield1+50; S:=S+50; END;
 TEXTOUT("+"+S,x1-.5,y1+2,2,RGB(100,100,255));
 END;
 IF Play=2 AND (d1≤2.2+r/10 OR d2≤2.2+r/10 OR d3≤2.2+r/10 OR M9(10,5)≤2+r/10) THEN S:=0;
  IF d1≤2.2+r/10 THEN Shield2:=Shield2+50; S:=S+50; END;
  IF d2≤2.2+r/10 THEN Shield2:=Shield2+50; S:=S+50; END;
  IF d3≤2.2+r/10 THEN Shield2:=Shield2+50; S:=S+50; END;
  IF M9(10,5)≤2+r/10 THEN Shield2:=Shield2+50; S:=S+50; END;
 TEXTOUT("+"+S,x2-.5,y2+2,2,RGB(100,100,255));
 END;
 IF Play=3 AND (d1≤2.2+r/10 OR d2≤2.2+r/10 OR d3≤2.2+r/10 OR M9(10,5)≤2+r/10) THEN S:=0;
  IF d1≤2.2+r/10 THEN Shield3:=Shield3+50; S:=S+50; END;
  IF d2≤2.2+r/10 THEN Shield3:=Shield3+50; S:=S+50; END;
  IF d3≤2.2+r/10 THEN Shield3:=Shield3+50; S:=S+50; END;
  IF M9(10,5)≤2+r/10 THEN Shield3:=Shield3+50; S:=S+50; END;
 TEXTOUT("+"+S,x3-.5,y3+2,2,RGB(100,100,255));
 END;
S:=0;
END;   //  Skill12
//TEXTOUT("作者:黎明lb",-16,-16);
IF Skill=19 AND times=0 THEN xp?x0?M9(5,14); yp?y0?M9(5,15); END;

0?M9(13,1);0?M9(13,2);0?M9(13,5);0?M9(13,6);0?M9(13,9);0?M9(13,10);
0?M9(13,3);0?M9(13,4);0?M9(13,7);0?M9(13,8);0?M9(13,11);0?M9(13,12);
IF d1≤2.2+r/10 AND Lp1>0 THEN 
 IF d1≥1.8 THEN Inj:=TRUNCATE(Inj*d1/2.75,2); IF d1≥2.2 THEN Inj:=Inj*.8; END; END;
   .2*(x1-xp)?M9(13,1);
   √(ABS(.8*d1^2-M9(13,1)^2))?M9(13,2); 0?M9(13,3); 0?M9(13,4);
    IF Skill=16 THEN Move1:=2; END;
 IF d1≤0.8+r/10 AND (Skill≤3 OR Skill=8 OR Skill=13 OR Skill=22) THEN Inj:=Inj*1.5; 
 TEXTOUT("暴击!",x1,y1+2,1,RGB(255,0,0));
 END;
IF Shield1=0 OR (4≤Skill AND Skill≤6) OR Skill=9 OR Skill=12 OR Skill=14 THEN Lp1:=Lp1-Inj;
ELSE
    IF Skill=3 THEN Inj:=Inj*1.3; TEXTOUT("破甲!",x1,y1+3,1,RGB(0,0,255)); END;
    IF Skill=21 AND Inj<150 THEN Inj:=Inj*0.8; TEXTOUT("未穿甲",x1-.5,y1+2,1,RGB(200,80,160)); END; 
 IF Shield1≥Inj THEN
  Shield1:=Shield1-Inj;
  ELSE
  Lp1:=Lp1+Shield1-Inj; Shield1:=0;
 END;
END;
M9(4,5):=M9(4,5)+Inj;
IF v0≠42 THEN M9(4,Play+1):=M9(4,Play+1)+Inj; END;
M9(4,1):=M9(4,1)+Inj;
TEXTOUT(Inj,x1,y1+1,2,RGB(150,50,0)); 
  IF r≠-.3 THEN Inj:=M9(5,16); ELSE Inj:=125; END;
//WAIT(0.02);
END;  //d1
IF d2≤2.2+r/10 AND Lp2>0 THEN
 IF d2≥1.8 THEN Inj:=TRUNCATE(Inj*d2/2.75,2); IF d2≥2.2 THEN Inj:=Inj*.8; END; END; 
   .2*(x2-xp)?M9(13,5);
   √(ABS(.8*d2^2-M9(13,5)^2))?M9(13,6); 0?M9(13,7); 0?M9(13,8);
    IF Skill=16 THEN Move2:=2; END;
 IF d2≤0.8+r/10 AND (Skill≤3 OR Skill=8 OR Skill=13 OR Skill=22) THEN Inj:=Inj*1.5;
 TEXTOUT("暴击!",x2,y2+2,1,RGB(255,0,0)); 
 END; 
IF Shield2=0 OR (4≤Skill AND Skill≤6) OR Skill=9 OR Skill=12 OR Skill=14 THEN Lp2:=Lp2-Inj;
ELSE
    IF Skill=3 THEN Inj:=Inj*1.3; TEXTOUT("破甲!",x2,y2+3,1,RGB(0,0,255)); END;
    IF Skill=21 AND Inj<150 THEN Inj:=Inj*0.8; TEXTOUT("未穿甲",x2-.5,y2+2,1,RGB(200,80,160)); END; 
 IF Shield2≥Inj THEN
  Shield2:=Shield2-Inj;
  ELSE
  Lp2:=Lp2+Shield2-Inj; Shield2:=0;
  END;
END;
M9(4,6):=M9(4,6)+Inj;
IF v0≠42 THEN M9(4,Play+1):=M9(4,Play+1)+Inj; END;
M9(4,1):=M9(4,1)+Inj;
TEXTOUT(Inj,x2,y2+1,2,RGB(150,50,0));
  IF r≠-.3 THEN Inj:=M9(5,16); ELSE Inj:=125; END;
END;
IF d3≤2.2+r/10 AND Lp3>0 THEN
 IF d3≥1.8 THEN Inj:=TRUNCATE(Inj*d3/2.75,2); IF d3≥2.2 THEN Inj:=Inj*.8; END; END; 
   .2*(x3-xp)?M9(13,9);
   √(ABS(.8*d3^2-M9(13,9)^2))?M9(13,10); 0?M9(13,11);0?M9(13,12);
    IF Skill=16 THEN Move3:=2; END;
 IF d3≤0.8+r/10 AND (Skill≤3 OR Skill=8 OR Skill=13 OR Skill=22) THEN Inj:=Inj*1.5;
 TEXTOUT("暴击!",x3,y3+2,1,RGB(255,0,0)); 
 END;
IF Shield3=0 OR (4≤Skill AND Skill≤6) OR Skill=9 OR Skill=12 OR Skill=14 THEN Lp3:=Lp3-Inj;
ELSE
    IF Skill=3 THEN Inj:=Inj*1.3; TEXTOUT("破甲!",x3,y3+3,1,RGB(0,0,255)); END;
    IF Skill=21 AND Inj<150 THEN Inj:=Inj*0.8; TEXTOUT("未穿甲",x3-.5,y3+2,1,RGB(200,80,160)); END; 
 IF Shield3≥Inj THEN
  Shield3:=Shield3-Inj;
  ELSE
  Lp3:=Lp3+Shield3-Inj; Shield3:=0;
  END;
END;
M9(4,7):=M9(4,7)+Inj;
IF v0≠42 THEN M9(4,Play+1):=M9(4,Play+1)+Inj; END;
M9(4,1):=M9(4,1)+Inj;
TEXTOUT(Inj,x3,y3+1,2,RGB(150,50,0));
  IF r≠-.3 THEN Inj:=M9(5,16); ELSE Inj:=125; END;
//WAIT(0.02);
END;

IF d1≤2.2+r/10 OR d2≤2.2+r/10 OR d3≤2.2+r/10 THEN Z:=0;
IF 2.2≤M9(5,17) AND d1≤2.2+r/10 THEN M9(5,17):=2.2; END; IF 2.2≤M9(5,18) AND d2≤2.2+r/10 THEN M9(5,18):=2.2; END; IF 2.2≤M9(5,19) AND d3≤2.2+r/10 THEN M9(5,19):=2.2; END;
 WHILE Z≤IP(Inj*2/25) DO Z:=Z+1;
  IF M9(5,17)≤2.2+r/10 THEN LINE(x1+.6,y1-.6,2*x1+1.8-xp+TRUNCATE(RANDOM(-Inj/125,Inj/125),1),2*y1-1.8-yp+TRUNCATE(RANDOM(-Inj/125,Inj/125),1),RGB(255-IP(M9(5,17)*110),50,IP(M9(5,17)*110))); END;
  IF M9(5,18)≤2.2+r/10 THEN LINE(x2+.6,y2-.6,2*x2+1.8-xp+TRUNCATE(RANDOM(-Inj/125,Inj/125),1),2*y2-1.8-yp+TRUNCATE(RANDOM(-Inj/125,Inj/125),1),RGB(255-IP(M9(5,18)*110),50,IP(M9(5,18)*110))); END;
  IF M9(5,19)≤2.2+r/10 THEN LINE(x3+.6,y3-.6,2*x3+1.8-xp+TRUNCATE(RANDOM(-Inj/125,Inj/125),1),2*y3-1.8-yp+TRUNCATE(RANDOM(-Inj/125,Inj/125),1),RGB(255-IP(M9(5,19)*110),50,IP(M9(5,19)*110))); END;
 END;
END;

IF d9≤2.2+r/10 THEN
  IF SinP=4 THEN WAIT(0.15); Inj:=250; M9(5,16):=Inj; r:=6.1; 1?R?Bomb; 0?a?SinP?Skill; xp:=x9; yp:=y9; K:=30; CONTINUE 1; END;
SinP:=0; TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(255,255,255)); -99?x9?y9;
END;
IF M9(10,5)≤2+r/10 AND r≠-6 AND M9(10,3)>0 THEN
  M9(10,3)-Inj?M9(10,3); M9(4,1):=M9(4,1)+Inj;
  IF Skill=16 THEN M9(10,6):=2; END;
  IF v0≠42 THEN M9(4,Play+1):=M9(4,Play+1)+Inj; END;
  IF M9(10,3)≤0 THEN M9(10,3):=0;
  TEXTOUT("枪",M9(10,1)-0.5,M9(10,2)+0.5,1,RGB(255,255,255)); WAIT(0.15);
  Inj:=220; M9(5,16):=Inj; r:=6.1; 1?R?Bomb; 0?Skill; xp:=M9(10,1); yp:=M9(10,2); K:=30; -99?M9(10,1);-99?M9(10,2); 
  CONTINUE 1; END;
TEXTOUT(Inj,M9(10,1),M9(10,2)+1,2,RGB(150,50,0));
  IF r≠-.3 THEN Inj:=M9(5,16); ELSE Inj:=150; END;
END;

IF 0≤Skill AND r≠-.3 AND v0≠42 AND (Skill≤3 OR Skill=8 OR Skill=9 OR Skill=13 OR Skill=16 OR Skill=18) AND (d1≤2.2+r/10 OR d2≤2.2+r/10 OR d3≤2.2+r/10 OR M9(10,5)≤2+r/10) THEN
 M9(4,Play+13):=M9(4,Play+13)+1;
END;
//Xmax:=15.9; Xmin:=-15.9; Ymax:=10.9; Ymin:=-10.9;
ARC(G1,xp,yp,15+r,{RGB(255,255,255),RGB(255,255,255)});
//WAIT(0.1);
//BLIT(G1);

IF Skill=5 THEN Z:=0;
 WHILE Z≤6 DO Z:=Z+1;
 RECT;
 BLIT(-15.9+(-1)^Z/8,10.9,15.9+(-1)^Z/8,-13,G1);
 WAIT(0.05);
 END;
END;

  IF M9(4,1)>0 THEN TEXTOUT("累伤: "+M9(4,1),-12.7,10.9,2,RGB(220,60,80),200,RGB(255,255,255)); END;

IF (d1≤2.2+r/10 OR d2≤2.2+r/10 OR d3≤2.2+r/10) AND Skill≠11 THEN
  REPEAT
  IF ABS(M9(13,2))≥0.001 AND y1>-16 THEN
 M9(13,3)+0.01?M9(13,3); M9(13,4)+0.01?M9(13,4);
 TEXTOUT("我",x1,y1,3,RGB(255,255,255)); 
 x1:=x1+M9(13,1)*M9(13,3); y1:=y1+M9(13,2)*M9(13,4)-5*M9(13,4)^2;
   IF GETPIX(x1+1.4,y1-.7)=Black THEN -ABS(.3*M9(13,1))?M9(13,1); M9(13,3):=0; END;
   IF GETPIX(x1-.1,y1-.7)=Black THEN ABS(.3*M9(13,1))?M9(13,1);  M9(13,3):=0; END;
   IF GETPIX(x1+.7,y1+.1)=Black THEN -ABS(M9(13,2))?M9(13,2); M9(13,4):=0; END;
   IF GETPIX(x1+.7,y1-1.4)=Black THEN ABS(M9(13,2)*.5)?M9(13,2); M9(13,4):=0; END;
 TEXTOUT("我",x1,y1,3,RGB(150,230,180));
 END;
  IF ABS(M9(13,6))≥0.001 AND y2>-16 THEN
 M9(13,7)+0.01?M9(13,7); M9(13,8)+0.01?M9(13,8);
 TEXTOUT("你",x2,y2,3,RGB(255,255,255));
 x2:=x2+M9(13,5)*M9(13,7); y2:=y2+M9(13,6)*M9(13,8)-5*M9(13,8)^2;
   IF GETPIX(x2+1.4,y2-.7)=Black THEN -ABS(.3*M9(13,5))?M9(13,5); END;
   IF GETPIX(x2-.1,y2-.7)=Black THEN ABS(.3*M9(13,5))?M9(13,5); END;
   IF GETPIX(x2+.7,y2+.1)=Black THEN -ABS(M9(13,6))?M9(13,6); END;
   IF GETPIX(x2+.7,y2-1.4)=Black THEN ABS(M9(13,6)*.5)?M9(13,6); M9(13,8):=0; END;
 TEXTOUT("你",x2,y2,3,RGB(50,150,255));
 END;
  IF ABS(M9(13,10))≥0.001 AND y3>-16 THEN
  M9(13,11)+0.01?M9(13,11); M9(13,12)+0.01?M9(13,12);
 TEXTOUT("他",x3,y3,3,RGB(255,255,255)); 
 x3:=x3+M9(13,9)*M9(13,11); y3:=y3+M9(13,10)*M9(13,12)-5*M9(13,12)^2;
   IF GETPIX(x3+1.4,y3-.7)=Black THEN -ABS(.3*M9(13,9))?M9(13,9); END;
   IF GETPIX(x3-.1,y3-.7)=Black THEN ABS(.3*M9(13,9))?M9(13,9); END;
   IF GETPIX(x3+.7,y3+.1)=Black THEN -ABS(M9(13,10))?M9(13,10); M9(13,12):=0; END;
   IF GETPIX(x3+.7,y3-1.4)=Black THEN ABS(M9(13,10)*.5)?M9(13,10); M9(13,12):=0; END;
 TEXTOUT("他",x3,y3,3,RGB(200,160,180)); 
 END;
WAIT(0.005);
  UNTIL
  (ABS(M9(13,2))≤0.001 OR y1≤-16) AND (ABS(M9(13,6))≤0.001 OR y2≤-16) AND (ABS(M9(13,10))≤0.001 OR y3≤-16)
 END;
END;
END;

IF (Lp1≤0 OR (y1≤-16 AND -16≤x1 AND x1≤16)) AND y1>-99 THEN
 BLIT(G1);
  REPEAT
    y1+0.1?y1;
    TEXTOUT("环",x1,y1+1.5,3,RGB(240,250,50),50,RGB(255,255,255));
    TEXTOUT("翅     翅",x1-1,y1-.5,1,RGB(180,190,255),100,RGB(255,255,255));
    TEXTOUT("我",x1,y1,3,RGB(150,230,180));
    WAIT(0.005);
  UNTIL y1≥13 END;
  IF Lp1>0 THEN y1:=-16; ELSE Lp1:=0; -99?x1?y1; END;
WAIT(0.1);
END;
IF (Lp2≤0 OR (y2≤-16 AND -16≤x2 AND x2≤16)) AND y2>-99 THEN
BLIT(G1);
  REPEAT
    y2+0.1?y2;
    TEXTOUT("环",x2,y2+1.5,3,RGB(240,250,50),50,RGB(255,255,255));
    TEXTOUT("翅     翅",x2-1,y2-.5,1,RGB(180,190,255),100,RGB(255,255,255));
    TEXTOUT("你",x2,y2,3,RGB(50,150,255));
    WAIT(0.005);
  UNTIL y2≥13 END;
  IF Lp2>0 THEN y2:=-16; ELSE Lp2:=0; -99?x2?y2; END;
WAIT(0.1);
END;
IF (Lp3≤0 OR (y3≤-16 AND -16≤x3 AND x3≤16)) AND y3>-99 THEN
BLIT(G1);
  REPEAT
    y3+0.1?y3;
    TEXTOUT("环",x3,y3+1.5,3,RGB(240,250,50),50,RGB(255,255,255));
    TEXTOUT("翅     翅",x3-1,y3-.5,1,RGB(180,190,255),100,RGB(255,255,255));
    TEXTOUT("他",x3,y3,3,RGB(200,160,180));
    WAIT(0.005);
  UNTIL y3≥13 END;
  IF Lp3>0 THEN y3:=-16; ELSE Lp3:=0; -99?x3?y3; END;
WAIT(0.1);
END;
  IF Lp1>0 AND y1≤-16 THEN TEXTOUT("我 已重新复活!",-4.5,1,3,RGB(150,230,180),200,RGB(255,255,255)); Lp1:=TRUNCATE(Lp1/2,1); 13?y1; TRUNCATE(RANDOM(-15,15),2)?x1; WAIT(0.5); END;
  IF Lp2>0 AND y2≤-16 THEN TEXTOUT("你 已重新复活!",-4.5,1,3,RGB(50,150,255),200,RGB(255,255,255)); Lp2:=TRUNCATE(Lp2/2,1); 13?y2; TRUNCATE(RANDOM(-15,15),2)?x2; WAIT(0.5); END;
  IF Lp3>0 AND y3≤-16 THEN TEXTOUT("他 已重新复活!",-4.5,1,3,RGB(200,160,180),200,RGB(255,255,255)); Lp3:=TRUNCATE(Lp3/2,1); 13?y3; TRUNCATE(RANDOM(-15,15),2)?x3; WAIT(0.5); END;
IF (Lp1≤0 AND Lp2≤0) OR (Lp1≤0 AND Lp3≤0) OR (Lp2≤0 AND Lp3≤0) THEN Play:=-2; K:=0; CONTINUE 1; END;

Z:=0;
REPEAT Z:=Z+1;
 IF M9(11,3*Z-1)=1 THEN
 d1:=√((M9(11,3*Z)+.5-xp)^2+(M9(11,3*Z+1)-.5-yp)^2);
//TEXTOUT([d1],-15.6,5,3,RGB(255,50,50),200,RGB(255,255,255)); WAIT;
   IF d1≤2+r/10 THEN WAIT(0.2);
BLIT(G1);
IF v0=42 THEN TEXTOUT("轰炸中...正在: "+times,-15.6,8,3,RGB(255,50,120),400,RGB(255,255,255)); END;
TEXTOUT("累伤: "+M9(4,1),-12.7,10.9,2,RGB(220,60,80),200,RGB(255,255,255));
TEXTOUT("我",x1,y1,3,RGB(150,230,180));
TEXTOUT("你",x2,y2,3,RGB(50,150,255));
TEXTOUT("他",x3,y3,3,RGB(200,160,180));
//     IF Z=1 THEN ARC(xp,yp,15+r,{RGB(255,255,255),RGB(255,255,255)}); END;
   .6*(M9(11,3*Z)-xp)?M9(12,4*Z-3); //√(ABS(.9*d1^2-M9(12,4*Z-3)^2))?M9(12,4*Z-2);
   .8*(M9(11,3*Z+1)-yp)?M9(12,4*Z-2);
//   TEXTOUT([M9(12,4*Z-3),M9(12,4*Z-2)],-15.6,5,3,RGB(255,50,50),200,RGB(255,255,255)); WAIT;
   0?M9(12,4*Z-1);0?M9(12,4*Z);
     REPEAT
      M9(12,4*Z-1)+0.01?M9(12,4*Z-1); M9(12,4*Z)+0.01?M9(12,4*Z);
      TEXTOUT("雷",M9(11,3*Z),M9(11,3*Z+1),1,RGB(255,255,255)); 
      M9(11,3*Z):=M9(11,3*Z)+M9(12,4*Z-3)*M9(12,4*Z-1); M9(11,3*Z+1):=M9(11,3*Z+1)+M9(12,4*Z-2)*M9(12,4*Z)-4*M9(12,4*Z)^2;
       IF GETPIX(M9(11,3*Z)+1,M9(11,3*Z+1)-.6)=Black THEN -ABS(.8*M9(12,4*Z-3))?M9(12,4*Z-3); 0?M9(12,4*Z-1); END;
       IF GETPIX(M9(11,3*Z)-.1,M9(11,3*Z+1)-.6)=Black THEN  ABS(.8*M9(12,4*Z-3))?M9(12,4*Z-3); 0?M9(12,4*Z-1); END;
       IF GETPIX(M9(11,3*Z)+.5,M9(11,3*Z+1)-1.2)=Black THEN ABS(M9(12,4*Z-2)*.8)?M9(12,4*Z-2); 0?M9(12,4*Z); END;
       IF GETPIX(M9(11,3*Z)+1.1,M9(11,3*Z+1)-1.1)≠Black AND M9(12,4*Z-3)≤.2 AND M9(12,4*Z-2)≤.2 THEN 1.8?M9(12,4*Z-3); 0?M9(12,4*Z-1); END;
       IF GETPIX(M9(11,3*Z)-.1,M9(11,3*Z+1)-1.1)≠Black AND M9(12,4*Z-3)≤.2 AND M9(12,4*Z-2)≤.2 THEN -1.8?M9(12,4*Z-3); 0?M9(12,4*Z-1); END;
      TEXTOUT("雷",M9(11,3*Z),M9(11,3*Z+1),1,RGB(50,30,60)); 
     //WAIT(0.003);
     UNTIL (ABS(M9(12,4*Z-3))≤0.01 AND ABS(M9(12,4*Z-2))≤0.01) OR M9(11,3*Z+1)≤-16 END;
   END;  //d1≤2
 END;
UNTIL Z≥M9(11,1) END;
IF M9(4,1)>0 THEN TEXTOUT("累伤: "+M9(4,1),-12.7,10.9,2,RGB(220,60,80),200,RGB(255,255,255)); END;

IF Round≥Players-1 THEN
Z:=0;
REPEAT Z:=Z+1;
 IF M9(11,3*Z-1)=1 AND
   ((ABS(M9(11,3*Z)-.2-x1)≤.82 AND ABS(M9(11,3*Z+1)+.2-y1)≤.82 AND Lp1>0) OR 
   (ABS(M9(11,3*Z)-.2-x2)≤.82 AND ABS(M9(11,3*Z+1)+.2-y2)≤.82 AND Lp2>0) OR
   (ABS(M9(11,3*Z)-.2-x3)≤.82 AND ABS(M9(11,3*Z+1)+.2-y3)≤.82 AND Lp3>0)) THEN
 TEXTOUT("雷",M9(11,3*Z),M9(11,3*Z+1),1,RGB(50,30,60));
 WAIT(0.2);
 Inj:=150; r:=-.3; xp:=M9(11,3*Z); yp:=M9(11,3*Z+1)-.8; 1?Bomb?R; K:=30;
   IF Skill≠0 THEN Skill?M9(5,13); Skill:=0; END;
 0?M9(11,3*Z-1); -99?M9(11,3*Z); -99?M9(11,3*Z+1);
 Z:=M9(11,1)+1;
 END;
UNTIL Z≥M9(11,1) END;
IF Z=M9(11,1)+1 THEN CONTINUE 1; END;
END;

IF Round≠70 AND Round≠100 AND Round≠120 AND M9(5,13)≥0 AND Skill≠7 AND Skill≠12 AND Skill≠14 AND Skill≠19 THEN WAIT(0.2); ELSE WAIT(0.05); END;
IF M9(5,13)>0 AND v0≠42 THEN Skill:=M9(5,13); END;

IF Skill=7 THEN Inj:=150;
IF times≤8 THEN
 IF Play=1 THEN M9(5,14):=x1; M9(5,15):=y1; END;
 IF Play=2 THEN M9(5,14):=x2; M9(5,15):=y2; END;
 IF Play=3 THEN M9(5,14):=x3; M9(5,15):=y3; END;
θ:=θ-1; times:=times+1; 0?R; 1?Bomb; K:=30; M9(5,14)?x0?xp; M9(5,15)?y0?yp; r:=0;
TRUNCATE(RANDOM(-1,1),2)+v0?v0;
TRUNCATE(RANDOM(-3,3),2)+θ?θ;
CONTINUE 1;
ELSE times:=0; END;
END;

IF Skill=19 THEN
IF times≤5 THEN
 IF W=3.33 THEN M9(5,14):=xp; M9(5,15):=yp; W:=0; END;
 IF M9(5,15)≤-16 THEN times:=99; END;
times:=times+1; 0?R; 1?Bomb; K:=30; Inj:=200; M9(5,16):=Inj; r:=1; M9(5,14)?x0; M9(5,15)?y0; 
TRUNCATE(RANDOM(40,55),1)?θ; TRUNCATE(RANDOM(0,6),2)?v0; 
 IF RANDOM(0,1)≥.5 THEN Dir:=1; ELSE Dir:=-1; END;
CONTINUE 1;
ELSE times:=0; END;
END;

IF Skill=12 THEN
IF times≤18 THEN
times:=times+1; R:=0; 1?Bomb; K:=30; θ:=-90; v0:=50; Inj:=85; M9(5,16):=Inj; r:=-8; 12?y0;
TRUNCATE(RANDOM(-4.5,4),1)+X?x0; 
CONTINUE 1;
ELSE times:=0; END;
END;

IF Skill=21 THEN
IF times≤7 THEN
 IF Play=1 THEN x0:=x1+.6; y0:=y1-.6; END;
 IF Play=2 THEN x0:=x2+.6; y0:=y2-.6; END;
 IF Play=3 THEN x0:=x3+.6; y0:=y3-.6; END;
 M9(7,20):=x0; M9(7,21):=y0; M9(5,14):=x0; M9(5,15):=y0;
times:=times+1; R:=0; 1?Bomb; K:=30; Inj:=I; r:=-6.5;
CONTINUE 1;
ELSE times:=0; END;
END;

//TEXTOUT([T,Skill],-15.6,5,3,RGB(255,50,50),200,RGB(255,255,255)); WAIT;
IF Skill=14 AND T<3 THEN
BLIT(G1);
TEXTOUT("我",x1,y1,3,RGB(150,230,180));
TEXTOUT("你",x2,y2,3,RGB(50,150,255));
TEXTOUT("他",x3,y3,3,RGB(200,160,180));
 R:=0; K:=30; CONTINUE 1; END; 

IF (Round=70 OR Round=100 OR Round=120) AND times≤29 AND (M9(5,13)≠-2 OR Cost=-1) THEN
TRUNCATE(RANDOM(-16,16),1)?x0; y0:=12; r:=0;Inj:=135; Skill:=0; T:=0; V:=0;
IF Round=100 THEN r:=2; Inj:=145; END;
IF Round=120 THEN r:=5; Inj:=160; END;
θ:=-90; times:=times+1; y0:=12; R:=0; Bomb:=1; K:=30; v0:=42; a:=0; Skill:=0;
CONTINUE 1;
END;
IF M9(5,13)≠0 AND M9(5,13)≠-2 THEN M9(5,13)?Skill; END;
IF M9(10,3)>0 AND Skill=15 THEN
 WHILE GETPIX(M9(10,1)-.4,M9(10,2)-.7)≠Black AND GETPIX(M9(10,1)+.4,M9(10,2)-.7)≠Black DO
   M9(10,2):=M9(10,2)-0.1;
   IF M9(10,2)≤-16 THEN M9(10,3):=0; -99?M9(10,1); -99?M9(10,2); END;
   TEXTOUT("枪",M9(10,1)-0.5,M9(10,2)+0.5,1,RGB(255,200,100),100,RGB(255,255,255));
 END;
END;

IF M9(4,5)≠0 OR M9(4,6)≠0 OR M9(4,7)≠0 THEN
BLIT(G1);
TEXTOUT("我",x1,y1,3,RGB(150,230,180));
TEXTOUT("你",x2,y2,3,RGB(50,150,255));
TEXTOUT("他",x3,y3,3,RGB(200,160,180));
 IF M9(4,5)≠0 AND Lp1>0 THEN  M9(4,8):=y1+.5; ELSE  M9(4,8):=99; END;
 IF M9(4,6)≠0 AND Lp2>0 THEN  M9(4,9):=y2+.5; ELSE  M9(4,9):=99; END;
 IF M9(4,7)≠0 AND Lp3>0 THEN M9(4,10):=y3+.5; ELSE M9(4,10):=99; END;
 REPEAT
 IF M9(4,8)≤14 THEN M9(4,8):=M9(4,8)+0.1; TEXTOUT(M9(4,5),x1-.5,M9(4,8),2,RGB(250,85,65),200,RGB(255,255,255)); END;
 IF M9(4,9)≤14 THEN M9(4,9):=M9(4,9)+0.1; TEXTOUT(M9(4,6),x2-.5,M9(4,9),2,RGB(250,85,65),200,RGB(255,255,255)); END;
 IF M9(4,10)≤14 THEN M9(4,10):=M9(4,10)+0.1; TEXTOUT(M9(4,7),x3-.5,M9(4,10),2,RGB(250,85,65),200,RGB(255,255,255)); END;
 WAIT(0.004);
 UNTIL M9(4,8)≥14 AND M9(4,9)≥14 AND M9(4,10)≥14 END;
END;

BLIT(G1);
IF M9(5,13)≠-2 THEN
TEXTOUT("我",x1,y1,3,RGB(150,230,180));
TEXTOUT("你",x2,y2,3,RGB(50,150,255));
TEXTOUT("他",x3,y3,3,RGB(200,160,180));
TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(100,255,200));
TEXTOUT("枪",M9(10,1)-0.5,M9(10,2)+0.5,1,RGB(255,200,100));
TEXTOUT(IP(Lp1/48)+"%",-6.3,6.8,2,RGB(150,230,180));
TEXTOUT(IP(Lp2/48)+"%",-6.3,5.8,2,RGB(50,150,255));
IF Players=3 THEN TEXTOUT(IP(Lp3/48)+"%",-6.3,4.8,2,RGB(200,160,180)); END;
Round:=Round+1; M9(10,4):=0;
ELSE S:=-2; M9(5,13):=0; END;
IF Cost=-1 AND Skill≤0 THEN Round:=Round+1; S:=-1;
  IF Play=1 THEN M9(7,9):=M9(7,9)-1; Lp1:=Lp1+300; TEXTOUT("+300",x1,y1+1,2,RGB(40,180,55)); IF Lp1>4800 THEN Lp1:=4800; END; END;
  IF Play=2 THEN M9(8,9):=M9(8,9)-1; Lp2:=Lp2+300; TEXTOUT("+300",x2,y2+1,2,RGB(40,180,55)); IF Lp2>4800 THEN Lp2:=4800; END; END;
  IF Play=3 THEN M9(9,9):=M9(9,9)-1; Lp3:=Lp3+300; TEXTOUT("+300",x3,y3+1,2,RGB(40,180,55)); IF Lp3>4800 THEN Lp3:=4800; END; END;
  WAIT(0.3);
END;
IF M9(5,13)=6 THEN WAIT(0.2); END;
IF Skill>0 OR M9(5,13)>0 THEN M9(5,13)?Skill;
IF Play=1 THEN Poi1:=Poi1-Cost; M9(1,Skill)-1?M9(1,Skill); END;
IF Play=2 THEN Poi2:=Poi2-Cost; M9(2,Skill)-1?M9(2,Skill); END;
IF Play=3 THEN Poi3:=Poi3-Cost; M9(3,Skill)-1?M9(3,Skill); END;
END;
IF Skill=9 THEN
 IF Play=1 AND Lp2=M9(8,6) AND Lp3=M9(9,6) THEN Poi1:=Poi1+Cost; END;
 IF Play=2 AND Lp1=M9(7,6) AND Lp3=M9(9,6) THEN Poi2:=Poi2+Cost; END;
 IF Play=3 AND Lp1=M9(7,6) AND Lp2=M9(8,6) THEN Poi3:=Poi3+Cost; END; 
END; 
   IF 0≤Skill AND (Skill≤3 OR Skill=8 OR Skill=9 OR Skill=13 OR Skill=16 OR Skill=18) THEN M9(4,Play+10):=M9(4,Play+10)+1;END; 
IF S≠-2 OR M9(5,21)=-2.99 THEN
TRUNCATE(RANDOM(0,4.01),2)?a;
ROUND(RANDOM(1,2),0)?Direct;
IF Direct=2 THEN a:=-a; END;
END;
   IF M9(10,3)>0 AND (times≥1 OR Skill=15) THEN (ROUND(x1,1)-M9(10,1))*ROUND(y1,1)?M9(5,4);  (ROUND(x2,1)-M9(10,1))*ROUND(y2,1)?M9(5,5); (ROUND(x3,1)-M9(10,1))*ROUND(y3,1)?M9(5,6); END; 
   0?t?T?Sua?R?Skill?Cost?r?times?K?V?I; 0?M9(5,13); Inj:=125; v0:=10; Bomb:=1; θ:=20; Rep:=-1; 20?d1?d2?d3?d9; 1?S;
     IF y1≤-20 AND Play=1 THEN Lp1:=0; -99?x1?y1; END;IF y2≤-20 AND Play=2 THEN Lp2:=0; -99?x2?y2; END;IF y3≤-20 THEN Lp3:=0; -99?x3?y3; END;
   Play:=Play+1; 0?M9(10,5); 0?M9(4,1); 0?M9(4,5); 0?M9(4,6); 0?M9(4,7); 0?M9(5,12);
IF Round=Pack THEN
IP(RANDOM(1,9))?SinP;
Pack:=IP(RANDOM(4,8))+Pack;
TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(255,255,255));
TRUNCATE(RANDOM(-14,15),1)?x9; y9:=12;
 WHILE GETPIX(x9-.4,y9-1.1)≠Black AND GETPIX(x9+.4,y9-1.1)≠Black DO
   y9:=y9-0.1; WAIT(0.005);
   IF y9≤-16 THEN SinP:=0; -99?x9?y9; BREAK; END;
   TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(100,255,200),100,RGB(255,255,255));
 END;
END;

IF Play>Players THEN 1?Play; END;
M9(5,3)+TICKS-M9(5,1)?M9(5,3); M9(5,1):=TICKS;
Players?M9(6,1); Play?M9(6,2); Direct?M9(6,3); a?M9(6,4); Round?M9(6,5); Pack?M9(6,6); x9?M9(6,7); y9?M9(6,8); SinP?M9(6,9); Comp?M9(6,10);
x1?M9(7,1); y1?M9(7,2); AFlue1?M9(7,3); Flue1?M9(7,4); Poi1?M9(7,5); Lp1?M9(7,6); Shield1?M9(7,7); Ref1?M9(7,8);
x2?M9(8,1); y2?M9(8,2); AFlue2?M9(8,3); Flue2?M9(8,4); Poi2?M9(8,5); Lp2?M9(8,6); Shield2?M9(8,7); Ref2?M9(8,8);
x3?M9(9,1); y3?M9(9,2); AFlue3?M9(9,3); Flue3?M9(9,4); Poi3?M9(9,5); Lp3?M9(9,6); Shield3?M9(9,7); Ref3?M9(9,8);
END;            //ENTER
 
IF ISKEYDOWN(0) THEN S:=1.11; Skill:=0; Cost:=0; P:=Play; Cover; Sua:=0; M9(5,12):=1; WAIT(0.2); END;
IF ISKEYDOWN(4) THEN 0?Skill?K?Cost; RECT(8.5,5.5,16,4); END;
 IF ISKEYDOWN(29) AND ((M9(7,9)≥1 AND Play=1 AND Lp1≤4800) OR (M9(8,9)≥1 AND Play=2 AND Lp2≤4800) OR (M9(9,9)≥1 AND Play=3 AND Lp3≤4800)) THEN
  Skill:=-2; K:=29; Cost:=-1;
  TEXTOUT("使用血包       ",8.5,5.5,3,RGB(240,80,80),300,RGB(255,255,255));
 //ELSE TEXTOUT("次数不够!      ",8.5,5.5,3,0,300,RGB(255,255,255));
 END;

IF Skill=0 THEN
  IF ISKEYDOWN(19) THEN Skill:=-1; Cost:=0;
  TEXTOUT("跳回合        ",8.5,5.5,3,RGB(180,180,160),300,RGB(255,255,255));
  END;
IF ISKEYDOWN(41)=1 AND K≠41 THEN 41?K; TEXTOUT("Shift....      ",8.5,5.5,3,RGB(100,100,100),300,RGB(255,255,255)); END;
IF ISKEYDOWN(41)=0 AND K≠41 THEN
 IF ISKEYDOWN(47) THEN
  IF (Play=1 AND Poi1≥3 AND Move1=0) OR (Play=2 AND Poi2≥3 AND Move2=0) OR (Play=3 AND Poi3≥3 AND Move3=0) THEN
   TEXTOUT("伤害提升      ",8.5,5.5,3,RGB(200,80,0),300,RGB(255,255,255));
   1?Skill; Cost:=3;
  ELSE Skill:=-10; Cost:=3; Q:=1;
  END;
 END;  //47
 IF ISKEYDOWN(48) THEN
  IF (Play=1 AND Poi1≥2 AND Move1=0) OR (Play=2 AND Poi2≥2 AND Move2=0) OR (Play=3 AND Poi3≥2 AND Move3=0) THEN
   TEXTOUT("进行瞬移      ",8.5,5.5,3,RGB(200,90,0),300,RGB(255,255,255));
   2?Skill; Cost:=2;
  ELSE Skill:=-10; Cost:=2; Q:=2;
  END; 
 END;  //48
 IF ISKEYDOWN(49) THEN
  IF (Play=1 AND Poi1≥4 AND Move1=0) OR (Play=2 AND Poi2≥4 AND Move2=0) OR (Play=3 AND Poi3≥4 AND Move3=0) THEN
   TEXTOUT("皇家穿甲蛋    ",8.5,5.5,3,RGB(200,90,50),300,RGB(255,255,255));
   3?Skill; Cost:=4;
  ELSE Skill:=-10; Cost:=4; Q:=3;
  END; 
 END;  //49
 IF ISKEYDOWN(42) THEN
  IF (Play=1 AND Poi1≥5 AND M9(1,4)>0 AND Move1=0) OR (Play=2 AND Poi2≥5 AND M9(2,4)>0 AND Move2=0) OR (Play=3 AND Poi3≥5 AND M9(3,4)>0 AND Move3=0) THEN
   TEXTOUT("空对地导蛋彈  ",8.5,5.5,3,RGB(200,90,100),300,RGB(255,255,255));
   4?Skill; Cost:=5;
  ELSE Skill:=-10; Cost:=5; Q:=4;
  END; 
 END;  //42
 IF ISKEYDOWN(43) THEN
  IF (Play=1 AND Poi1≥10 AND M9(1,5)>0 AND Move1=0) OR (Play=2 AND Poi2≥10 AND M9(2,5)>0 AND Move2=0) OR (Play=3 AND Poi3≥10 AND M9(3,5)>0 AND Move3=0) THEN
   TEXTOUT("天姫,参上!    ",8.5,5.5,3,RGB(200,90,150),300,RGB(255,255,255));
   5?Skill; Cost:=10;
  ELSE Skill:=-10; Cost:=10; Q:=5;
  END; 
 END;  //43
 IF ISKEYDOWN(44) THEN
  IF (Play=1 AND Poi1≥8 AND M9(1,6)>0 AND Move1=0) OR (Play=2 AND Poi2≥8 AND M9(2,6)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥8 AND M9(3,6)>0 AND Move3=0) THEN
   TEXTOUT("爆炸飞羊     ",8.5,5.5,3,RGB(200,90,200),300,RGB(255,255,255));
   6?Skill; Cost:=8;
  ELSE Skill:=-10; Cost:=8; Q:=6;
  END; 
 END;  //44
 IF ISKEYDOWN(37) THEN
  IF (Play=1 AND Poi1≥7 AND M9(1,7)>0 AND Move1=0) OR (Play=2 AND Poi2≥7 AND M9(2,7)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥7 AND M9(3,7)>0 AND Move3=0) THEN
   TEXTOUT("Fox3导弹      ",8.5,5.5,3,RGB(200,90,200),300,RGB(255,255,255));
   7?Skill; Cost:=7;
  ELSE Skill:=-10; Cost:=7; Q:=7;
  END;
 END;  //37
 IF ISKEYDOWN(38) THEN
  IF (Play=1 AND Poi1≥2 AND M9(1,8)>0 AND Move1=0) OR (Play=2 AND Poi2≥2 AND M9(2,8)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥2 AND M9(3,8)>0 AND Move3=0) THEN
   TEXTOUT("护盾充能       ",8.5,5.5,3,RGB(150,90,200),300,RGB(255,255,255));
   8?Skill; Cost:=2;
  ELSE Skill:=-10; Cost:=2; Q:=8;
  END; 
 END;  //38
 IF ISKEYDOWN(39) THEN
  IF (Play=1 AND Poi1≥6 AND M9(1,9)>0 AND Move1=0) OR (Play=2 AND Poi2≥6 AND M9(2,9)>0 AND Move2=0)
    OR (Play=3 AND Poi3≥6 AND M9(3,9)>0 AND Move3=0) THEN
   TEXTOUT("天降正义!      ",8.5,5.5,3,RGB(255,200,60),300,RGB(255,255,255));
   9?Skill; Cost:=6;
  ELSE Skill:=-10; Cost:=6; Q:=9;
  END; 
 END;  //39
 IF ISKEYDOWN(32) THEN
  IF (Play=1 AND Poi1≥3 AND M9(1,10)>0 AND Move1=0) OR (Play=2 AND Poi2≥3 AND M9(2,10)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥3 AND M9(3,10)>0 AND Move3=0) THEN
   TEXTOUT("移动到平台     ",8.5,5.5,3,RGB(255,100,255),300,RGB(255,255,255));
   10?Skill; Cost:=3;
  ELSE Skill:=-10; Cost:=3; Q:=10;
  END; 
 END;  //32
 IF ISKEYDOWN(33) THEN
  IF (Play=1 AND Poi1≥2 AND Move1=0) OR (Play=2 AND Poi2≥2 AND Move2=0) OR (Play=3 AND Poi3≥2 AND Move3=0) THEN
   TEXTOUT("升竜拳!        ",8.5,5.5,3,RGB(255,100,255),300,RGB(255,255,255));
   11?Skill; Cost:=2;
  ELSE Skill:=-10; Cost:=2; Q:=11;
  END; 
 END;  //33
 IF ISKEYDOWN(34) THEN
  IF (Play=1 AND Poi1≥7 AND M9(1,12)>0 AND Move1=0) OR (Play=2 AND Poi2≥7 AND M9(2,12)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥7 AND M9(3,12)>0 AND Move3=0) THEN
   TEXTOUT("裁雨留虹       ",8.5,5.5,3,RGB(100,100,255),300,RGB(255,255,255));
   12?Skill; Cost:=7;
  ELSE Skill:=-10; Cost:=7; Q:=12;
  END; 
 END;  //34
             ELSE  
 IF ISKEYDOWN(47) THEN
  IF (Play=1 AND Poi1≥2 AND Ref1=0 AND Move1=0) OR (Play=2 AND Poi2≥2 AND Ref2=0 AND Move2=0)
     OR (Play=3 AND Poi3≥2 AND Ref3=0 AND Move3=0) THEN
   TEXTOUT("抛射物保护     ",8.5,5.5,3,RGB(30,80,255),300,RGB(255,255,255));
   13?Skill; Cost:=2;
  ELSE Skill:=-10; Cost:=2; Q:=13;
  END;
 END;  //47
 IF ISKEYDOWN(48) THEN
  IF (Play=1 AND Poi1≥6 AND M9(1,14)>0 AND Move1=0) OR (Play=2 AND Poi2≥6 AND M9(2,14)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥6 AND M9(3,14)>0 AND Move3=0) THEN
   TEXTOUT("南蛮冲撞      ",8.5,5.5,3,RGB(200,90,200),300,RGB(255,255,255));
   14?Skill; Cost:=6;
  ELSE Skill:=-10; Cost:=6; Q:=14;
  END; 
 END;  //44
 IF ISKEYDOWN(49) THEN
  IF (Play=1 AND Poi1≥6 AND M9(1,15)>0 AND Move1=0) OR (Play=2 AND Poi2≥6 AND M9(2,15)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥6 AND M9(3,15)>0 AND Move3=0) THEN
   IF M9(10,3)>0 THEN TEXTOUT("只能有一个    ",8.5,5.5,3,RGB(255,100,100),200,RGB(255,255,255)); ELSE
   TEXTOUT("堡垒机关枪     ",8.5,5.5,3,RGB(255,200,100),300,RGB(255,255,255));
   15?Skill; Cost:=6; Play?M9(5,11);
    END;
  ELSE Skill:=-10; Cost:=6; Q:=15;
  END; 
 END;  //32
 IF ISKEYDOWN(42) THEN
  IF (Play=1 AND Poi1≥3 AND M9(1,16)>0 AND Move1=0) OR (Play=2 AND Poi2≥3 AND M9(2,16)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥3 AND M9(3,16)>0 AND Move3=0) THEN
   TEXTOUT("电弧陷阱     ",8.5,5.5,3,RGB(255,100,255),300,RGB(255,255,255));
   16?Skill; Cost:=3;
  ELSE Skill:=-10; Cost:=3; Q:=16;
  END; 
 END;  //42
 IF ISKEYDOWN(43) THEN
  IF (Play=1 AND Poi1≥4 AND M9(1,17)>0 AND Move1=0) OR (Play=2 AND Poi2≥4 AND M9(2,17)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥4 AND M9(3,17)>0 AND Move3=0) THEN
   TEXTOUT("钻井弹       ",8.5,5.5,3,RGB(255,100,50),300,RGB(255,255,255));
   17?Skill; Cost:=4;
  ELSE Skill:=-10; Cost:=4; Q:=17;
  END; 
 END;  //43
 IF ISKEYDOWN(44) THEN
  IF (Play=1 AND Poi1≥4 AND M9(1,18)>0 AND Move1=0) OR (Play=2 AND Poi2≥4 AND M9(2,18)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥4 AND M9(3,18)>0 AND Move3=0) THEN
   TEXTOUT("半程追踪弹    ",8.5,5.5,3,RGB(190,100,250),300,RGB(255,255,255));
   18?Skill; Cost:=4;
  ELSE Skill:=-10; Cost:=4; Q:=18;
  END;
 END;  //44
 IF ISKEYDOWN(37) THEN
  IF (Play=1 AND Poi1≥6 AND M9(1,19)>0 AND Move1=0) OR (Play=2 AND Poi2≥6 AND M9(2,19)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥6 AND M9(3,19)>0 AND Move3=0) THEN
   TEXTOUT("散装弹        ",8.5,5.5,3,RGB(50,100,200),300,RGB(255,255,255));
   19?Skill; Cost:=6;
  ELSE Skill:=-10; Cost:=6; Q:=19;
  END;
 END;  //37
 IF ISKEYDOWN(38) THEN
  IF (Play=1 AND Poi1≥3 AND M9(1,20)>0 AND Move1=0) OR (Play=2 AND Poi2≥3 AND M9(2,20)>0 AND Move2=0)
     OR (Play=3 AND Poi3≥3 AND M9(3,20)>0 AND Move3=0) THEN
   TEXTOUT("战墙          ",8.5,5.5,3,RGB(50,50,50),300,RGB(255,255,255));
   20?Skill; Cost:=3;
  ELSE Skill:=-10; Cost:=3; Q:=20;
  END;
 END;  //38
 IF ISKEYDOWN(39) THEN
  IF (Play=1 AND Poi1≥4 AND M9(1,21)>0 AND Move1=0) OR (Play=2 AND Poi2≥3 AND M9(2,21)>0 AND Move2=0)
    OR (Play=3 AND Poi3≥4 AND M9(3,21)>0 AND Move3=0) THEN
   TEXTOUT("充能左轮枪      ",8.5,5.5,3,RGB(160,235,255),300,RGB(255,255,255));
   21?Skill; Cost:=4;
  ELSE Skill:=-10; Cost:=4; Q:=21;
  END;
 END;  //39
 IF ISKEYDOWN(32) THEN
  IF (Play=1 AND Poi1≥4 AND M9(1,22)>0 AND Move1=0) OR (Play=2 AND Poi2≥3 AND M9(2,22)>0 AND Move2=0)
    OR (Play=3 AND Poi3≥4 AND M9(3,22)>0 AND Move3=0) THEN
   TEXTOUT("爆破网球          ",8.5,5.5,3,RGB(60,235,55),300,RGB(255,255,255));
   22?Skill; Cost:=4;
  ELSE Skill:=-10; Cost:=4; Q:=22;
  END;
 END;  //32
END;   // 41 Shift
END;   //Skill=0

 IF Skill=-10 THEN
  CASE
   IF ((Play=1 AND M9(1,Q)≤0) OR (Play=2 AND M9(2,Q)≤0) OR (Play=3 AND M9(3,Q)≤0)) AND Q≥4 AND Q≠11 AND Q≠13 AND Q≠20 THEN
    TEXTOUT("次数不够!      ",8.5,5.5,3,0,300,RGB(255,255,255));
   END;
   IF Move1≠0 OR Move2≠0 OR Move3≠0 THEN
    TEXTOUT("无法使用!      ",8.5,5.5,3,0,300,RGB(255,255,255));
   END;
   IF (Play=1 AND Poi1<Cost) OR (Play=2 AND Poi2<Cost) OR (Play=3 AND Poi3<Cost) THEN
    TEXTOUT("点数不够!      ",8.5,5.5,3,0,300,RGB(255,255,255));
   END;
  END;
  Skill:=0; Cost:=0; Q:=0;
 END;  //unable skill

IF ISKEYDOWN(50) OR ISKEYDOWN(45) THEN
 IF ISKEYDOWN(50) AND v0<24 THEN
 v0:=v0+1;
 END;
 IF ISKEYDOWN(45) AND v0>5 THEN
 v0:=v0-1;
 RECT(-13.5,9.2,-3.5,8.5);
 END;
RECT(-13.5,9.2,-13.5+(v0-5)/1.9,8.5,RGB(v0*10,255-v0*9,v0*4)); 
WAIT(0.1);
END;

IF Sua=0 THEN
Z:=0;
REPEAT Z:=Z+1;
 WHILE M9(11,3*Z-1)=1 AND GETPIX(M9(11,3*Z)+.2,M9(11,3*Z+1)-1)≠Black AND GETPIX(M9(11,3*Z)+.8,M9(11,3*Z+1)-1)≠Black AND M9(11,3*Z+1)>-16 DO
 RECT(M9(11,3*Z),M9(11,3*Z+1),M9(11,3*Z)+.9,M9(11,3*Z+1)-1);
 M9(11,3*Z+1):=M9(11,3*Z+1)-0.1;
 TEXTOUT("雷",M9(11,3*Z),M9(11,3*Z+1),1,RGB(50,30,60)); 
 END;
UNTIL Z=M9(11,1) END;
  IF M=-9.9 OR Round<Players THEN 
   Z:=0;
   REPEAT Z:=Z+1; TEXTOUT("雷",M9(11,3*Z),M9(11,3*Z+1),1,RGB(50,30,60)); UNTIL Z=M9(11,1) END; 
  END;
IF M=-9.9 AND M9(6,21)≠0 THEN Ref1:=1; Ref2:=1; Ref3:=1; END;
IF M=-9.9 THEN TEXTOUT("调试模式....",-3,2.5,3,RGB(255,0,0)); END;
  IF M9(10,3)>0 THEN TEXTOUT("枪",M9(10,1)-0.5,M9(10,2)+0.5,1,RGB(255,200,100));
    RECT(-13.7,5,-8.3,4,RGB(255,130,50),RGB(255,255,255));
    RECT(-13.5,4.8,-13.5+M9(10,3)/100,4.2,RGB(90,255,130));
    TEXTOUT(M9(10,3),-12,4.9,1,RGB(60,90,255)); 
  END;
 IF Ref1≠0 THEN ARC(x1+0.7,y1-0.7,10,-40,220,RGB(50,60,255)); END;
 IF Ref2≠0 THEN ARC(x2+0.7,y2-0.7,10,-40,220,RGB(50,60,255)); END;
 IF Ref3≠0 THEN ARC(x3+0.7,y3-0.7,10,-40,220,RGB(50,60,255)); END;
RECT(-2.5,6.8,1.7,4);
IF Direct=2 THEN
 TEXTOUT("<<  风",-2.5,6.8,2,RGB(0,150,230)); 
 ELSE
 TEXTOUT("    风  >>",-2.5,6.8,2,RGB(0,150,230));
 END;
TEXTOUT(ABS(a*25),-2,5.5,2,RGB(50,150,240));
IF Round≥67 THEN
 IF Round≤70 THEN TEXTOUT("距离下次轰炸还有"+(70-Round)+"回合",-8,3.8,3,RGB(255,50,100)); END;
 IF 97≤Round AND Round≤100 THEN TEXTOUT("距离下次轰炸还有"+(100-Round)+"回合",-8,3.8,3,RGB(255,50,100)); END;
 IF 117≤Round AND Round≤120 THEN TEXTOUT("距离下次轰炸还有"+(120-Round)+"回合",-8,3.8,3,RGB(255,50,100)); END;
END;
IF M9(5,12)=0 THEN
IF Play=1 AND Move1≥1 THEN Move1:=Move1-1; END;
IF Play=2 AND Move2≥1 THEN Move2:=Move2-1; END;
IF Play=3 AND Move3≥1 THEN Move3:=Move3-1; END;
END;
 IF Move1≥1 THEN ARC(x1+0.7,y1-0.7,8.5,-40,220,RGB(255,60,255)); LINE(x1,y1,x1+1.3,y1-1.3,RGB(255,20,150)); LINE(x1,y1-1.3,x1+1.3,y1,RGB(255,20,150)); END;
 IF Move2≥1 THEN ARC(x2+0.7,y2-0.7,8.5,-40,220,RGB(255,60,255)); LINE(x2,y2,x2+1.3,y2-1.3,RGB(255,20,150)); LINE(x2,y2-1.3,x2+1.3,y2,RGB(255,20,150)); END;
 IF Move3≥1 THEN ARC(x3+0.7,y3-0.7,8.5,-40,220,RGB(255,60,255)); LINE(x3,y3,x3+1.3,y3-1.3,RGB(255,20,150)); LINE(x3,y3-1.3,x3+1.3,y3,RGB(255,20,150)); END;
IF Lp1>0 THEN TEXTOUT("我",x1,y1,3,RGB(150,230,180)); ELSE TEXTOUT("我",x1,y1,3,RGB(255,255,255)); END;
IF Lp2>0 THEN TEXTOUT("你",x2,y2,3,RGB(50,150,255)); ELSE TEXTOUT("你",x2,y2,3,RGB(255,255,255)); END; 
IF Lp3>0 THEN TEXTOUT("他",x3,y3,3,RGB(200,160,180)); ELSE TEXTOUT("他",x3,y3,3,RGB(255,255,255)); END;
TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(100,255,200));
TEXTOUT("枪",M9(10,1)-0.5,M9(10,2)+0.5,1,RGB(255,200,100));
 IF M9(10,6)≥1 THEN ARC(M9(10,1),M9(10,2),7.2,-40,220,RGB(255,60,255)); END;
IF Play=1 THEN TEXTOUT("我",.5,10,4,RGB(150,230,180)); END;
IF Play=2 THEN TEXTOUT("你",.5,10,4,RGB(50,150,255)); END;
IF Play=3 THEN TEXTOUT("他",.5,10,4,RGB(200,160,180)); END;
RECT(-6.3,6.8,-3.2,4);
TEXTOUT(IP(Lp1/48)+"%",-6.3,6.8,2,RGB(150,230,180));
TEXTOUT(IP(Lp2/48)+"%",-6.3,5.8,2,RGB(50,150,255));
IF Players=3 THEN TEXTOUT(IP(Lp3/48)+"%",-6.3,4.8,2,RGB(200,160,180)); END;
END;

IF Play=1 THEN
x0:=x1; y0:=y1;
IF Lp1≤0 OR y1≤-99 THEN Lp1:=0; IF y1≤-20 THEN -99?x1?y1; Sua:=1; END; K:=30; Skill:=-2; END;
IF -20≤y1 AND y1≤-16 THEN K:=30; Skill:=-2; END;
IF Sua=0 AND Lp1>0 THEN
  IF Skill=0 AND M9(5,12)=0 THEN M9(5,12):=-3;
    IF M9(10,6)≥1 AND M9(5,11)=1 THEN M9(10,6):=M9(10,6)-1; END;
  IF AFlue1+Flue1>10 OR AFlue1≥10 THEN
  AFlue1+Flue1-10?AFlue1;
  Flue1:=10;
  ELSE
  AFlue1+Flue1?Flue1;
  IF AFlue1<10 THEN  0?AFlue1; END; 
  END;
    Poi1:=Poi1+1; M9(7,5):=Poi1;
    AFlue1?M9(7,3); Flue1?M9(7,4);
 END;
  Cover; 1?Sua;
  TEXTOUT(Round,-2.5,9.4,4);
  TEXTOUT(Lp1,7,11,4,RGB(50+IP((4800-Lp1)/24),240-IP((4800-Lp1)/20),50),300,RGB(255,255,255));
  TEXTOUT(Shield1,7,7.2,3,RGB(50,50,200),300,RGB(255,255,255));
  RECT(3,8.8,3+Lp1/400,7.7,RGB(50+IP((4800-Lp1)/24),240-IP((4800-Lp1)/20),50));
  RECT(3,8.8,3+Shield1/400,7.7,RGB(50,50,250));
  TEXTOUT(Poi1,-9.2,7,4,RGB(50,150,200),300,RGB(255,255,255));
  TEXTOUT(AFlue1,-6,8,2,RGB(180,120,120),200,RGB(255,255,255));
  TEXTOUT("作者:黎明lb",-16,-16);
  RECT(-15.4,4.2+Flue1/2,-14.2,4.2,RGB(IP(255-Flue1*20),IP(Flue1*25.5),IP(Flue1*10)));
  RECT(-13.5,9.2,-13.5+(v0-5)/1.9,8.5,RGB(v0*10,255-v0*9,v0*4)); 
  TEXTOUT("?",x1+.5,y1+2,4,RGB(50,255,100));
END;

 IF (ISKEYDOWN(8) OR ISKEYDOWN(7)) AND Move1=0 AND Lp1>0 THEN
  IF ISKEYDOWN(8) AND Flue1>0 THEN
     IF GETPIX(x1+1.4,y1-0.4)≠Black AND GETPIX(x1+1.4,y1-.2)≠Black THEN
      x1+0.1?x1;
      Flue1-0.1?Flue1;
     END; 
  END;
  IF ISKEYDOWN(7) AND Flue1>0 THEN
     IF GETPIX(x1-0.2,y1-0.4)≠Black AND GETPIX(x1-.1,y1-.2)≠Black THEN
      x1-0.1?x1;
      Flue1-0.1?Flue1;
     END; 
  END;
      IF (GETPIX(x1+.2,y1-1.4)=Black OR GETPIX(x1+1.3,y1-1.4)=Black) AND Flue1>0 THEN
       y1+0.2?y1;
      END;
  RECT(-15.4,4.2,-14.2,9.2);
  RECT(-15.4,4.2+Flue1/2,-14.2,4.2,RGB(IP(255-Flue1*20),IP(Flue1*25.5),IP(Flue1*10)));
  WAIT(0.02);
  RECT(x1-0.1,y1-0.3,x1+1.3,y1-1.2);
  TEXTOUT("我",x1,y1,3,RGB(150,230,180));
 END;
END;

IF Play=2 THEN
x0:=x2; y0:=y2;
IF Lp2≤0 OR y2≤-99 THEN Lp2:=0;  IF y2≤-20 THEN -99?x2?y2; Sua:=1; END; K:=30; Skill:=-2; END;
IF -20≤y2 AND y2≤-16 THEN K:=30; Skill:=-2; END;
IF Sua=0 AND Lp2>0 THEN
 IF Skill=0 AND M9(5,12)=0 THEN M9(5,12):=-3;
    IF M9(10,6)≥1 AND M9(5,11)=2 THEN M9(10,6):=M9(10,6)-1; END;
  IF AFlue2+Flue2>10 OR AFlue2≥10 THEN
  AFlue2+Flue2-10?AFlue2; Flue2:=10;
  ELSE
  AFlue2+Flue2?Flue2;
  IF AFlue2<10 THEN  0?AFlue2; END; 
  END;
     Poi2:=Poi2+1; M9(8,5):=Poi2;
     AFlue2?M9(8,3); Flue1?M9(8,4);
 END;
  Cover; 1?Sua;
  TEXTOUT(Round,-2.5,9.4,4);
  TEXTOUT(Lp2,7,11,4,RGB(50+IP((4800-Lp2)/24),240-IP((4800-Lp2)/20),50),300,RGB(255,255,255));
  TEXTOUT(Shield2,7,7.2,3,RGB(50,50,200),300,RGB(255,255,255));
  RECT(3,8.8,3+Lp2/400,7.7,RGB(50+IP((4800-Lp2)/24),240-IP((4800-Lp2)/20),50));
  RECT(3,8.8,3+Shield2/400,7.7,RGB(50,50,250));  
  TEXTOUT(Poi2,-9.2,7,4,RGB(50,150,200),300,RGB(255,255,255));
  TEXTOUT(AFlue2,-6,8,2,RGB(180,120,120),200,RGB(255,255,255));
  RECT(-15.4,4.2+Flue2/2,-14.2,4.2,RGB(IP(255-Flue2*20),IP(Flue2*25.5),IP(Flue2*10)));
  RECT(-13.5,9.2,-13.5+(v0-5)/1.9,8.5,RGB(v0*10,255-v0*9,v0*4)); 
  TEXTOUT("?",x2+0.5,y2+2,4,RGB(50,255,100));
END;

 IF (ISKEYDOWN(8) OR ISKEYDOWN(7)) AND Move2=0 AND Lp2>0 THEN
  IF ISKEYDOWN(8) AND Flue2>0 THEN 
     IF GETPIX(x2+1.4,y2-0.4)≠Black AND GETPIX(x2+1.4,y2-.2)≠Black THEN
      x2+0.1?x2;
      Flue2-0.1?Flue2;
     END; 
  END;
  IF ISKEYDOWN(7) AND Flue2>0 THEN
     IF GETPIX(x2-0.2,y2-0.4)≠Black AND GETPIX(x2-.1,y2-.2)≠Black AND Flue2>0 THEN
      x2-0.1?x2;
      Flue2-0.1?Flue2;
     END; 
  END;
      IF (GETPIX(x2+.2,y2-1.4)=Black OR GETPIX(x2+1.3,y2-1.4)=Black) AND Flue2>0 THEN
       y2+0.2?y2;
      END;
  RECT(-15.4,4.2,-14.2,9.2);
  RECT(-15.4,4.2+Flue2/2,-14.2,4.2,RGB(IP(255-Flue2*20),IP(Flue2*25.5),IP(Flue2*10)));
  WAIT(0.02);
  RECT(x2-0.1,y2-0.3,x2+1.3,y2-1.2);
  TEXTOUT("你",x2,y2,3,RGB(50,150,255));
 END;
END;

IF Play=3 THEN
IF Lp3≤0 OR y3≤-99 THEN Lp3:=0;  IF y3≤-20 THEN -99?x3?y3; Sua:=1; END; K:=30; Skill:=-2; END;
IF -20≤y3 AND y3≤-16 THEN K:=30; Skill:=-2; END;
IF Sua=0 AND Lp3>0 THEN
  IF Skill=0 AND M9(5,12)=0 THEN M9(5,12):=-3;
    IF M9(10,6)≥1 AND M9(5,11)=3 THEN M9(10,6):=M9(10,6)-1; END;
  IF AFlue3+Flue3>10 OR AFlue3≥10 THEN
  AFlue3+Flue3-10?AFlue3; Flue3:=10;
  ELSE
  AFlue3+Flue3?Flue3;
  IF AFlue3<10 THEN  0?AFlue3; END; 
  END;
    Poi3:=Poi3+1; M9(9,5):=Poi3;
    AFlue3?M9(9,3); Flue3?M9(9,4);
 END;
  Cover;   1?Sua;
  TEXTOUT(Round,-2.5,9.4,4);
  TEXTOUT(Lp3,7,11,4,RGB(50+IP((4800-Lp3)/24),240-IP((4800-Lp3)/20),50),300,RGB(255,255,255));
  TEXTOUT(Shield3,7,7.2,3,RGB(50,50,200),300,RGB(255,255,255));
  RECT(3,8.8,3+Lp3/400,7.7,RGB(50+IP((4800-Lp3)/24),240-IP((4800-Lp3)/20),50));
  RECT(3,8.8,3+Shield3/400,7.7,RGB(50,50,250));
  TEXTOUT(Poi3,-9.2,7,4,RGB(50,150,200),300,RGB(255,255,255));
  TEXTOUT(AFlue3,-6,8,2,RGB(180,120,120),200,RGB(255,255,255));
  RECT(-15.4,4.2+Flue3/2,-14.2,4.2,RGB(IP(255-Flue3*20),IP(Flue3*25.5),IP(Flue3*10)));
  RECT(-13.5,9.2,-13.5+(v0-5)/1.9,8.5,RGB(v0*10,255-v0*9,v0*4)); 
  TEXTOUT("?",x3+0.5,y3+2,4,RGB(50,255,100));
END;
x0:=x3; y0:=y3;

 IF (ISKEYDOWN(8) OR ISKEYDOWN(7)) AND Move3=0 AND Lp3>0 THEN
  IF ISKEYDOWN(8) AND Flue3>0 THEN 
     IF GETPIX(x3+1.4,y3-0.4)≠Black AND GETPIX(x3+1.4,y3-.2)≠Black THEN
      x3+0.1?x3;
      Flue3-0.1?Flue3;
     END; 
  END;
  IF ISKEYDOWN(7) AND Flue3>0 THEN
     IF GETPIX(x3-0.2,y3-0.4)≠Black AND GETPIX(x3-0.1,y3-.2)≠Black THEN
      x3-0.1?x3;
      Flue3-0.1?Flue3;
     END; 
  END;
      IF (GETPIX(x3+.2,y3-1.4)=Black OR GETPIX(x3+1.3,y3-1.4)=Black) AND Flue3>0 THEN
       y3+0.2?y3;
      END;
  RECT(-15.4,4.2,-14.2,9.2);
  RECT(-15.4,4.2+Flue3/2,-14.2,4.2,RGB(IP(255-Flue3*20),IP(Flue3*25.5),IP(Flue3*10)));
  WAIT(0.02);
  RECT(x3-0.1,y3-0.3,x3+1.3,y3-1.2);
  TEXTOUT("他",x3,y3,3,RGB(200,160,180));
 END;
END;

IF ISKEYDOWN(40) THEN Dir:=-Dir; WAIT(0.2);
  LINE(x0+0.6,y0,x0+.6-Dir,y0+TAN(θ),RGB(255,255,255));
  LINE(x0+0.6,y0,x0+.6+Dir,y0+TAN(θ));
END;
IF ISKEYDOWN(35) THEN C:=7.77; Z:=v0; Skill:=0; Cost:=0; Cover; v0:=Z; Sua:=0; S:=0; END;
IF ISKEYDOWN(2) OR ISKEYDOWN(12) THEN
LINE(x0+0.6,y0,x0+0.6+Dir,y0+TAN(θ),RGB(255,255,255));
  IF θ≤-60 OR θ≥80 THEN
  45?θ; Dir:=-Dir;
  END;
IF ISKEYDOWN(2) AND θ≤80 THEN θ:=θ+1; END;
IF ISKEYDOWN(12) AND θ≥-60 THEN θ:=θ-1; END;
   LINE(x0+.6,y0,x0+.6+Dir,y0+TAN(θ));
   WAIT(0.02);
RECT(-16,3.8,-13.5,2.5);
TEXTOUT(θ,-15.8,3.8,3,RGB(120,120,120));
END;

IF SinP≠0 THEN
 IF ABS(x9-x1-.5)≤1.2 AND ABS(y9-y1+.5)≤1.2 THEN
   IF SinP=1 THEN IF Lp1+300≤4800 THEN Lp1:=Lp1+300; ELSE Lp1:=4800; END; TEXTOUT("+300",x1,y1+1,2,RGB(50,255,50)); END;    //你的生日在那一行呢
   IF SinP=2 THEN Shield1:=Shield1+200; TEXTOUT("+200",x1,y1+1,2,RGB(50,50,255)); END;
   IF SinP=3 THEN Poi1:=Poi1+3; TEXTOUT("+3",x1,y1+1,2,RGB(50,200,255)); END;
   IF SinP=4 THEN AFlue1:=AFlue1+10; TEXTOUT("+10",x1,y1+1,2,RGB(250,200,200)); END;
   IF SinP=5 THEN TEXTOUT("空包",x1,y1+1,2,RGB(150,150,155)); END;
   IF SinP=6 THEN Poi1:=Poi1+2; TEXTOUT("+2",x1,y1+1,2,RGB(50,200,255)); END;
   IF SinP=7 THEN Ref1:=1; TEXTOUT("盾!",x1,y1+1,2,RGB(150,180,255)); END;
   IF SinP=8 THEN M9(7,9):=M9(7,9)+1; TEXTOUT("血包",x1,y1+1,2,RGB(240,180,55)); END;
 TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(255,255,255));
 SinP:=0; Sua:=0; -99?x9?y9; M9(5,12):=1;
 END;
 IF ABS(x9-x2-.5)≤1.2 AND ABS(y9-y2+.5)≤1.2 THEN
   IF SinP=1 THEN IF Lp2+300≤4800 THEN Lp2:=Lp2+300; ELSE Lp2:=4800; END; TEXTOUT("+300",x2,y2+1,2,RGB(50,255,50)); END;
   IF SinP=2 THEN Shield2:=Shield2+200; TEXTOUT("+200",x2,y2+1,2,RGB(50,50,255)); END;
   IF SinP=3 THEN Poi2:=Poi2+3; TEXTOUT("+3",x2,y2+1,2,RGB(50,200,255)); END;
   IF SinP=4 THEN AFlue2:=AFlue2+10; TEXTOUT("+10",x2,y2+1,2,RGB(250,200,200)); END;
   IF SinP=5 THEN TEXTOUT("空包",x2,y2+1,2,RGB(150,150,155)); END;
   IF SinP=6 THEN Poi2:=Poi2+2; TEXTOUT("+2",x2,y2+1,2,RGB(50,200,255)); END;
   IF SinP=7 THEN Ref2:=1; TEXTOUT("盾!",x2,y2+1,2,RGB(150,180,255)); END;
   IF SinP=8 THEN M9(8,9):=M9(8,9)+1; TEXTOUT("血包",x2,y2+1,2,RGB(240,180,55)); END;
   TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(255,255,255));
   SinP:=0; Sua:=0; -99?y9?x9; M9(5,12):=1;
 END;
 IF ABS(x9-x3-.5)≤1.2 AND ABS(y9-y3+.5)≤1.2 THEN
   IF SinP=1 THEN IF Lp3+300≤4800 THEN Lp3:=Lp3+300; ELSE Lp3:=4800; END; TEXTOUT("+300",x3,y3+1,2,RGB(50,255,50)); END;
   IF SinP=2 THEN Shield3:=Shield3+200; TEXTOUT("+200",x3,y3+1,2,RGB(50,50,255)); END;
   IF SinP=3 THEN Poi3:=Poi3+3; TEXTOUT("+3",x3,y3+1,2,RGB(50,200,255)); END;   IF SinP=4 THEN AFlue3:=AFlue3+10; TEXTOUT("+10",x3,y3+1,2,RGB(250,200,200)); END;
   IF SinP=5 THEN TEXTOUT("空包",x3,y3+1,2,RGB(150,150,155)); END;
   IF SinP=6 THEN Poi3:=Poi3+2; TEXTOUT("+2",x3,y3+1,2,RGB(50,200,255)); END;
   IF SinP=7 THEN Ref3:=1; TEXTOUT("盾!",x3,y3+1,2,RGB(150,180,255)); END;
   IF SinP=8 THEN M9(9,9):=M9(9,9)+1; TEXTOUT("血包",x3,y3+1,2,RGB(240,180,55)); END;
 TEXTOUT("包",x9-0.5,y9+0.5,3,RGB(255,255,255));
 SinP:=0; Sua:=0;-99?x9?y9; M9(5,12):=1;
 END;
END;

IF Play=-2 THEN
 X:=-1; Y:=13; RECT;
 REPEAT WAIT(0.005); Y:=Y-0.1;
  TEXTOUT("d b",X-0.7,Y+0,6,RGB(240,230,0));
  TEXTOUT("U",X,Y,6,RGB(240,230,0));
  TEXTOUT("⊥",X-0.3,Y-1.2,6,RGB(240,230,0));
 UNTIL Y=4 END;
 RECT;
  TEXTOUT("d b",X-0.7,Y+0,6,RGB(240,230,0));
  TEXTOUT("U",X,Y,6,RGB(240,230,0));
  TEXTOUT("⊥",X-0.3,Y-1.2,6,RGB(240,230,0));
 TEXTOUT("手    手",X-0.8,Y-3.2,1);
 TEXTOUT("C h a r W a r",X-4.2,Y-4.2,5,RGB(255,200,200));
 TEXTOUT("W I N N E R",X-3.8,Y-5.8,5,RGB(255,200,200));
  IF Lp1>0 OR Lp2>0 OR Lp3>0 THEN
 IF Lp3>0 THEN TEXTOUT("他",X,Y-3.5,3,RGB(200,160,180)); END;
 IF Lp2>0 THEN TEXTOUT("你",X,Y-3.5,3,RGB(50,150,255)); END;
 IF Lp1>0 THEN TEXTOUT("我",X,Y-3.5,3,RGB(150,230,180)); END;
  ELSE
 TEXTOUT("???",X,Y-3.8,3,RGB(150,50,50));
 END;
    IF 0≤Skill AND (Skill≤3 OR Skill=8 OR Skill=9 OR Skill=13 OR Skill=16 OR Skill=18) THEN M9(4,Play+10):=M9(4,Play+10)+1;END;
  IF M9(4,11)=0 THEN M9(4,11):=1; END; IF M9(4,12)=0 THEN M9(4,12):=1; END; IF M9(4,13)=0 THEN M9(4,13):=1; END;
 TEXTOUT("我的累伤: "+M9(4,2),-15.9,10.8,3,RGB(150,230,180));
 TEXTOUT("你的累伤: "+M9(4,3),-15.9,8.8,3,RGB(50,150,255));
 TEXTOUT("他的累伤: "+M9(4,4),-15.9,6.8,3,RGB(200,160,180));
 TEXTOUT("我的命中率: "+ROUND(M9(4,14)/M9(4,11),4)*100+"%",3.5,10.8,3,RGB(150,230,180));
 TEXTOUT("你的命中率: "+ROUND(M9(4,15)/M9(4,12),4)*100+"%",3.5,8.8,3,RGB(50,150,255));
 TEXTOUT("他的命中率: "+ROUND(M9(4,16)/M9(4,13),4)*100+"%",3.5,6.8,3,RGB(200,160,180));
 TEXTOUT("点击任意键继续",X-5,Y-10,5);
 TICKS?M9(5,2); ROUND(M9(5,3)/1000,0)?T;
 TEXTOUT("用时: "+IP(T/60)+" 分 "+ROUND(FP(T/60)*60,1)+" 秒",-6,-8,5,RGB(230,80,130));
 Play:=-1;
 WAIT;
 0?M9;
END;

UNTIL Play=-1 END;
END;


EXPORT Cover() //5.36
BEGIN
IF C=2.22 THEN K:=-2;
MAKELIST(-2*X+8,X,1,16)?L9; RECT;
TEXTOUT(" Testing Assistant",3,10,3,RGB(IP(RANDOM(0,255)),IP(RANDOM(0,255)),IP(RANDOM(0,255))));
TEXTOUT("    调试助手菜单",4,8,3,RGB(IP(RANDOM(0,255)),IP(RANDOM(0,255)),IP(RANDOM(0,255))));
TEXTOUT("    ESC返回战场",4,6,3,RGB(IP(RANDOM(0,255)),IP(RANDOM(0,255)),IP(RANDOM(0,255))));
TEXTOUT("注意:需先按Vars键",2,4,3,RGB(255,0,0));
REPEAT
   IF MOUSE(1)≥150 THEN K:=12 END;
   IF MOUSE(1)>0 AND MOUSE(1)<1150 THEN K:=2 END;
   IF MOUSE(1)=-1 AND K≠-2 THEN K:=0; END;
IF ISKEYDOWN(2) OR ISKEYDOWN(12) OR K=2 OR K=12 OR K=-2 THEN
IF K=-2 THEN K:=0; END;
   IF (ISKEYDOWN(2)=1 OR K=2) AND L9(1)≥8 THEN K:=-1; L9-2?L9; RECT(-16,11,2,-15); END;
   IF (ISKEYDOWN(12)=1 OR K=12) AND L9(16)≤4 THEN K:=-1; L9+2?L9; RECT(-16,11,2,-15); END;
RECT(-15.8,6,2,4,RGB(200,100,50),RGB(255,255,255));
TEXTOUT("和 X^Y键(F)   自动瞄准 我",-15,L9(1),3,RGB(60,80,230));
TEXTOUT("和 SIN键(G)   自动瞄准 你",-15,L9(2),3,RGB(60,80,230));
TEXTOUT("和 COS键(H)   自动瞄准 他",-15,L9(3),3,RGB(60,80,230));
TEXTOUT("和 TAN(I)     自动瞄准 包",-15,L9(4),3,RGB(60,80,230));
TEXTOUT("和 LN键(J)    自动瞄准 枪",-15,L9(5),3,RGB(60,80,230));
TEXTOUT("和 X^2(L) 将在下回合出现包",-15.2,L9(6),3,RGB(60,80,230));
TEXTOUT("和 +/-键(J)   将包改为油包",-15,L9(7),3,RGB(60,80,230));

RECT(-15.9,10.9,2,9.5,RGB(0,0,0),RGB(255,255,255));
TEXTOUT("快捷键       作用描述",-15.8,10.9,3,RGB(200,120,90));
WAIT(0.12);
END;    //..UP AND DOWN
IF ISKEYDOWN(4) THEN C:=0; BLIT(G1); END;
UNTIL C≠2.22 END;
S:=-2; Sua:=0;
END;   //C2.22

IF C=7.77 THEN C:=0;
INPUT({θ,Z},"输入角度与力度",{"角度","力度"},"角度不能超过80或-60,力度不能超过23或5");
θ:=IP(θ);  Z:=IP(Z);
IF θ>80 THEN θ:=79; END; IF θ<-60 THEN θ:=-59; END; 
IF Z>23 THEN Z:=23; END; IF θ<5 THEN Z:=5; END;
S:=-2; Sua:=0; BLIT(G1);
END;

IF C=-9.99 THEN C:=0; Z:=0; {}?L9;
CHOOSE(Z,"要改变的参数","生命值","护盾值","位置","枪","玩家回合及补给包","风","地图");
 IF Z=1 THEN INPUT({M9(7,6),M9(8,6),M9(9,6)},"生命值",{"我","你","他"},"玩家生命值不要超过4200"); END;
 IF Z=2 THEN INPUT({M9(7,7),M9(8,7),M9(9,7),M9(6,21)},"护盾值",{"我","你","他","强加抛射物保护(不为0)"}); END;
 IF Z=3 THEN INPUT({M9(7,1),M9(7,2),M9(8,1),M9(8,2),M9(9,1),M9(9,2)},"位置",
   {"我x","我y","你x","你y","他x","他y"}); END;
 IF Z=4 THEN INPUT({M9(5,11),M9(10,4),M9(10,3),M9(10,1),M9(10,2)},"枪",{"枪主人","状态","枪生命值","枪x","枪y"},{"1为玩家我,2为玩家你,3为玩家他","0为准备状态,1为休息状态"}); END;
 IF Z=5 THEN INPUT({M9(6,1),M9(6,2),M9(6,5),M9(6,6),M9(6,9),M9(6,7),M9(6,8)},"玩家,回合及补给包",{"玩家数","玩家回合","回合","出现补给包回合","补给包内容","包x","包y"},
   {"","","","","1:LP,2:护盾,3:3点数,4:10油,5:空包,6:2点数,7:抛射物"}); END;
 IF Z=6 THEN INPUT({M9(6,3),M9(6,4)},"风",{"风向","风速"},{"1为左风,2为右风","正数为左风,负数为右风,-4.00~4.00,*25即为等级"}); END;
 IF Z=7 THEN D:=6.66; ELSE S:=-2; Sua:=0; BLIT(G1); END;
END;  //C=-9.99

IF C=6.66 THEN C:=0; K:=-1; I:=0; WAIT(0.2);
IF GROBW(G1)=32 THEN BLIT(G0,G1); ELSE DIMGROB(G1,32,24); END;
TEXTOUT("Apps开始游戏   Esc更换地图",-8,5,3,RGB(250,140,55));
TEXTOUT("+键 保存地图  Enter载入地图",-8,3,3,RGB(200,50,255));
TEXTOUT("Vars键 载入存档",-5,1,3,RGB(255,200,50));
TEXTOUT("退格键 自定义地图",-5.5,-1,3,RGB(50,255,200));
TEXTOUT("乘号 保存存档  除号 删除存档",-8,-3,3,RGB(200,120,0));

REPEAT
IF ISKEYDOWN(30) AND K≠30 THEN
  IF GROBW(G2)≠32 THEN TEXTOUT("载入没有地图    ",1,3,3,RGB(255,0,0),200,RGB(255,255,255));
   ELSE K:=30; I:=0; BLIT(G1,G2); BLIT(G0,G2); TEXTOUT("载入地图成功",-6,5,7,RGB(200,100,255)); END; 
END;
IF ISKEYDOWN(4) THEN K:=4;
 DIMGROB(G1,32,24); 150?Y;
 FOR Z FROM 0 TO 320 DO
 TRUNCATE(RANDOM(-3,3),2)?A;
 Y+A?Y;
 LINE_P(G1,Z,Y,Z,240,RGB(255,200,200));
 X+1?X;
 END;
TRUNCATE(RANDOM(20,180))?X;
TRUNCATE(RANDOM(20,180))?Y;
FILLPOLY_P(G1,{{X,Y},{X*2,Y/1.5},{X*3+30,Y*1.2-30},{X-20,Y*2-60}},RGB(255,200,200));
TRUNCATE(RANDOM(20,180))?X;
FILLPOLY_P(G1,{{X/1.2,Y*1.2},{X*2,Y*1.4},{X*3,Y/1.5},{X/1.6,Y*2}},RGB(255,200,200));
//TRIANGLE_P(G1,{265,145,RGB(128,0,255),90},{240,220,RGB(255,200,50),100},{195,157,RGB(196,0,0),128});
BLIT(G1);
TEXTOUT("Apps开始游戏   Esc更换地图",-8,5,3,RGB(250,140,55));
TEXTOUT("+键 保存地图  Enter载入地图",-8,3,3,RGB(200,50,255));
TEXTOUT("Vars键 载入存档",-5,1,3,RGB(255,200,50));
TEXTOUT("退格键 自定义地图",-5.5,-1,3,RGB(50,255,200));
TEXTOUT("乘号 保存存档  除号 删除存档",-8,-3,3,RGB(200,120,0));
END;
IF ISKEYDOWN(14) THEN K:=1; Z:=-1; SIZE(L8)?A;
  IF A=0 THEN CHOOSE(Z,"载入存档","存档: 默认存档"); END;
  IF A=1 THEN CHOOSE(Z,"载入存档","存档: 默认存档","存档1: "+L8(1)); END;
  IF A=2 THEN CHOOSE(Z,"载入存档","存档: 默认存档","存档1: "+L8(1),"存档2: "+L8(2)); END;
  IF A≥3 THEN CHOOSE(Z,"载入存档","存档: 默认存档","存档1: "+L8(A-2),"存档2: "+L8(A-1),"存档3: "+L8(A)); END;
IF Z=1 THEN IFERR M9(13,1) THEN MSGBOX("没有遊戏数据"); KILL; ELSE Z:=-2; A:=-1; END; END;
 IF (Z=2 AND GROBW(G9)≤30) OR (Z=3 AND GROBW(G8)≤30) OR (Z=4 AND GROBW(G7)≤30) THEN MSGBOX("错误:地图丢失"); KILL; END;
IF Z=2 THEN IFERR M1(13,21) THEN MSGBOX("错误:数据丢失"); KILL; END; M1?M9; BLIT(G1,G9); END;
IF Z=3 THEN IFERR M2(13,21) THEN MSGBOX("错误:数据丢失"); KILL; END; M2?M9; BLIT(G1,G8); END;
IF Z=4 THEN IFERR M3(13,21) THEN MSGBOX("错误:数据丢失"); KILL; END; M3?M9; BLIT(G1,G7); END;
IF Z≠-1 THEN RECT; TEXTOUT("载入存档成功",-4,1,3,RGB(200,160,80)); I:=3.33;
 ELSE MSGBOX("爷不载了"); K:=-1;
 BLIT(G1);
 TEXTOUT("Apps开始游戏   Esc更换地图",-8,5,3,RGB(250,140,55));
 TEXTOUT("+键 保存地图  Enter载入地图",-8,3,3,RGB(200,50,255));
 TEXTOUT("Vars键 载入存档",-5,1,3,RGB(255,200,50));
 TEXTOUT("退格键 自定义地图",-5.5,-1,3,RGB(50,255,200));
 TEXTOUT("乘号 保存存档  除号 删除存档",-8,-5,3,RGB(200,120,50));
 END;
WAIT(0.1);
 END;
IF ISKEYDOWN(15) THEN K:=15; BLIT(G1); END; 
IF ISKEYDOWN(50) THEN DIMGROB(G2,32,24); BLIT(G2,G1); TEXTOUT("保存地图成功喵",-9,3,3,RGB(100,255,200),200,RGB(255,255,255)); END;
IF ISKEYDOWN(19) THEN Z:=2;
 CHOOSE(Z,"这样将会开心一局喔?","继续","取消");
 IF Z=1 THEN D:=6.66; K:=19; CharEdit; ELSE C:=6.66; Cover; END; 
END;
IF ISKEYDOWN(40) THEN {}?L0;
 IFERR M9(13,1) THEN MSGBOX("没有遊戏数据"); KILL; ELSE
 INPUT(L0,"保存存档","存档名","注:存档名要加双引号外面加大括号,重名将覆档");
 B:=-1;
IF SIZE(L0)=0 THEN MSGBOX("已取消"); ELSE
IFERR L8(1) THEN ELSE
 IF L8(1)=L0(1) THEN Z:=-1;
  CHOOSE(Z,"你想要覆盖存档1? "+L8(1),"是","否");
  IF Z=1 THEN BLIT(G9,G1); M9?M1; B:=1; END;END;
END;
IFERR L8(2) THEN ELSE 
 IF L8(2)=L0(1) THEN Z:=-1;
  CHOOSE(Z,"你想要覆盖存档2? "+L8(2),"是","否");
  IF Z=1 THEN BLIT(G8,G1); M9?M2; B:=2; END;END;
END;
IFERR L8(3) THEN ELSE
 IF L8(3)=L0(1) THEN Z:=-1;
  CHOOSE(Z,"你想要覆盖存档3? "+L8(3),"是","否");
  IF Z=1 THEN BLIT(G7,G1); M9?M3; B:=3; END;END;
END;
IF Z=2 THEN MSGBOX("已取消"); B:=-2; END;
IF Z=1 AND B≠-1 THEN Z:=0; MSGBOX("已覆盖存档: "+B); END;

IF B=-1 THEN
 IFERR M1(13,1) THEN M9?M1; DIMGROB(G9,32,24); BLIT(G9,G1); 1?B; L0(1)?L8(1); ELSE
  IFERR M2(13,1) THEN M9?M2; DIMGROB(G8,32,24); BLIT(G8,G1); 2?B; L0(1)?L8(2); ELSE
   IFERR M3(13,1) THEN M9?M3; DIMGROB(G7,32,24); BLIT(G7,G1); 3?B; L0(1)?L8(3);
   END;
  END; 
 END;  //M9.M0
END;
 IF B≠-1 AND B≠-2 THEN
 MSGBOX("存档成功!命名:\n"+L0(1)+"\n档位: "+B); ELSE
 MSGBOX("存档失败!\n空位不足!\n或被取消");
 END;
    END;  //Esc
 WAIT(0.2);
END;   // M9?
BLIT(G1);
TEXTOUT("Apps开始游戏   Esc更换地图",-8,5,3,RGB(250,140,55));
TEXTOUT("+键 保存地图  Enter载入地图",-8,3,3,RGB(200,50,255));
TEXTOUT("Vars键 载入存档",-5,1,3,RGB(255,200,50));
TEXTOUT("退格键 自定义地图",-5.5,-1,3,RGB(50,255,200));
TEXTOUT("乘号 保存存档  除号 删除存档",-8,-5,3,RGB(200,120,50));
END;  // 存档 
IF ISKEYDOWN(35) THEN Z:=-1; SIZE(L8)?A;
 IF A≥3 THEN CHOOSE(Z,"删除存档","存档1: "+L8(A-2),"存档2: "+L8(A-1),"存档3: "+L8(A)); END;
 IF A=2 THEN CHOOSE(Z,"删除存档","存档1: "+L8(1),"存档2: "+L8(2)); END;
 IF A=1 THEN CHOOSE(Z,"删除存档","存档1: "+L8(1)); END;
IF Z≠-1 THEN MSGBOX("已删除存档: "+Z);
 ELSE MSGBOX("已取消"); END;
IF Z=1 THEN 0?M1; DIMGROB(G9,0,0); "无存档"?L8(1); END;IF Z=2 THEN 0?M2; DIMGROB(G8,0,0); "无存档"?L8(2); END;IF Z=3 THEN 0?M3; DIMGROB(G7,0,0); "无存档"?L8(3); END;
  IFERR L8(1) THEN ELSE IF L8(1)="无存档" THEN DIMGROB(G9,0,0); 0?M1; END; END;
  IFERR L8(2) THEN ELSE IF L8(2)="无存档" THEN DIMGROB(G8,0,0); 0?M2; END; END;
  IFERR L8(3) THEN ELSE IF L8(3)="无存档" THEN DIMGROB(G7,0,0); 0?M3; END; END;

IFERR L8(1) THEN MSGBOX("刪了个芥末"); ELSE
 IF L8(1)="无存档" THEN
  IFERR L8(2) THEN DIMGROB(G9,0,0); SUPPRESS(L8,1)?L8; ELSE M2?M1; DIMGROB(G9,32,24); BLIT(G9,G8); L8(2)?L8(1); DIMGROB(G8,0,0); 0?M2; SUPPRESS(L8,2)?L8; END;
  IFERR L8(2) THEN ELSE M3?M2; DIMGROB(G8,32,24); BLIT(G8,G7); DIMGROB(G7,0,0); 0?M3; END;
 ELSE
 IF L8(2)="无存档" THEN
  IFERR L8(3) THEN SUPPRESS(L8,2)?L8; ELSE
   M3?M2; DIMGROB(G8,32,24); BLIT(G8,G7); L8(3)?L8(2); DIMGROB(G7,0,0); 0?M3; SUPPRESS(L8,3)?L8; 
  END;
 ELSE
 IF L8(3)="无存档" THEN DIMGROB(G7,0,0); 0?M3; SUPPRESS(L8,3)?L8; END;
 END;
 END; 
END;   //L8(1)
 
BLIT(G1);
TEXTOUT("Apps开始游戏   Esc更换地图",-8,5,3,RGB(250,140,55));
TEXTOUT("+键 保存地图  Enter载入地图",-8,3,3,RGB(200,50,255));
TEXTOUT("Vars键 载入存档",-5,1,3,RGB(255,200,50));
TEXTOUT("退格键 自定义地图",-5.5,-1,3,RGB(50,255,200));
TEXTOUT("乘号 保存存档  除号 删除存档",-8,-5,3,RGB(200,120,50));
END;   //删除存档
UNTIL ISKEYDOWN(0) OR K=1 OR K=15 END;
   IF K≠30 AND K≠4 AND K≠15 AND K≠19 THEN K:=0; END;
   IF D=-1.11 THEN K:=-1.11; D:=0; END;
   IF I=3.33 THEN K:=-1; END; 
 IFERR M9(13,1) THEN ELSE
  IF K=0 AND ((M9(7,6)>0 AND M9(8,6)>0) OR (M9(7,6)>0 AND M9(9,6)>0) OR (M9(8,6)>0 AND M9(9,6)>0)) THEN
  K:=-2; I:=3.33; WAIT(0.2); BLIT(G1);
  TEXTOUT("Apps确认确认开新",-5,5,3,RGB(150,240,255));
  TEXTOUT("Vars键 载入存档",-5,1,3,RGB(255,200,50));
  TEXTOUT("看到有存档喔 确认开新?",-7,7,3,RGB(255,20,80));
   REPEAT
    IF ISKEYDOWN(14) THEN K:=1; END;
    IF ISKEYDOWN(0) OR ISKEYDOWN(15) THEN K:=0; END; 
   UNTIL K≠-2 END; 
  END;
 END;
 IF K=-1.11 THEN K:=0; END;
 IF I≠3.33 THEN S:=-1; ELSE M9(5,12):=1; S:=-2; END;
END;   //6.66 C

IF S=1.11 THEN K:=-2; Z:=1; LOCAL Key;
MAKELIST(-2*X+8,X,1,22)?L9; RECT;
TEXTOUT(" 仄里是技能菜单!",5,10,3,RGB(80,80,180));
TEXTOUT("  Esc返回战场",5,8,3,RGB(180,120,90));
TEXTOUT("Apps查看技能详情",4.5,6,3,RGB(180,30,255));
TEXTOUT("退格键跳回合",4.5,4,3,RGB(70,90,160));
TEXTOUT("剩余次数:",5,2,3,RGB(255,60,60));
TEXTOUT("剩余血包:"+M9(P+6,9),5,0,3,RGB(255,60,60));
TEXTOUT("当前槽位:",5,-2,3,RGB(255,60,60));
WAIT(0.2);
REPEAT
   IF MOUSE(1)≥150 THEN K:=12 END;
   IF MOUSE(1)>0 AND MOUSE(1)<150 THEN K:=2 END;
   IF MOUSE(1)=-1 AND K≠-2 THEN K:=0; END;
   CASE
   IF ISKEYDOWN(47)  THEN Key:=1; END; IF ISKEYDOWN(48)  THEN Key:=2; END; IF ISKEYDOWN(49) THEN Key:=3; END;
   IF ISKEYDOWN(42)  THEN Key:=4; END; IF ISKEYDOWN(43)  THEN Key:=5; END; IF ISKEYDOWN(44) THEN Key:=6; END;
   IF ISKEYDOWN(37)  THEN Key:=7; END; IF ISKEYDOWN(38)  THEN Key:=8; END; IF ISKEYDOWN(39) THEN Key:=9; END;
   IF ISKEYDOWN(32) THEN Key:=10; END; IF ISKEYDOWN(33) THEN Key:=11; END; IF ISKEYDOWN(34) THEN Key:=12; END;
   END;
    IF ISKEYDOWN(41) THEN
     CASE
     IF ISKEYDOWN(47)  THEN Key:=13; END; IF ISKEYDOWN(48)  THEN Key:=14; END; IF ISKEYDOWN(49) THEN Key:=15; END;
     IF ISKEYDOWN(42)  THEN Key:=16; END; IF ISKEYDOWN(43)  THEN Key:=17; END; IF ISKEYDOWN(44) THEN Key:=18; END;
     IF ISKEYDOWN(37)  THEN Key:=19; END; IF ISKEYDOWN(38)  THEN Key:=20; END; IF ISKEYDOWN(39) THEN Key:=21; END;
     IF ISKEYDOWN(32)  THEN Key:=22; END;
     END;
    END; 
   IF Key≠0 THEN MAKELIST(-2*X+8,X,2-Key,23-Key)?L9; RECT(-16,11,2,-15); Z:=Key; END;
IF ISKEYDOWN(2) OR ISKEYDOWN(12) OR K=2 OR K=12 OR K=-2 OR Key≠0 THEN
IF K=-2 THEN K:=0; END; Key:=0;
   IF (ISKEYDOWN(2)=1 OR K=2) AND L9(1)≥8 THEN K:=-1; L9-2?L9; Z:=Z-1; RECT(-16,11,2,-15); END;
   IF (ISKEYDOWN(12)=1 OR K=12) AND L9(22)≤4 THEN K:=-1; L9+2?L9; Z:=Z+1; RECT(-16,11,2,-15); END;
RECT(11.2,2,15,.5); RECT(11.2,-2,15,-3.5);
TEXTOUT(Z,11.2,-2,3,RGB(100,80,250));
 IF Z>3 AND Z≠11 AND Z≠13 THEN TEXTOUT(M9(P,Z),11.2,2,3,RGB(120,80,255));
   ELSE TEXTOUT("无限",11.2,2,3,RGB(120,80,255)); END; 
RECT(-15.8,6,2,4,RGB(200,100,50),RGB(255,255,255));
TEXTOUT("(0)          3 伤害翻倍",-15,L9(1),4,RGB(60,80,230));
TEXTOUT("(.)          2 进行瞬移",-15,L9(2),4,RGB(60,80,230));
TEXTOUT("(空格)    4 皇加穿甲弹",-15,L9(3),4,RGB(60,80,230));
TEXTOUT("(1)          5 空对地导蛋",-15,L9(4),4,RGB(60,80,230));
TEXTOUT("(2)         10 天姫,参上!",-15,L9(5),4,RGB(60,80,230));
TEXTOUT("(3)          8 爆炸飞羊",-15,L9(6),4,RGB(60,80,230));
TEXTOUT("(4)          7 Forx3导弹",-15,L9(7),4,RGB(60,80,230));
TEXTOUT("(5)          2 护盾充能",-15,L9(8),4,RGB(60,80,230));
TEXTOUT("(6)          6 天降正义!",-15,L9(9),4,RGB(60,80,230));
TEXTOUT("(7)          3 移动到平台",-15,L9(10),4,RGB(60,80,230));
TEXTOUT("(8)          2 升龙拳!",-15,L9(11),4,RGB(60,80,230));
TEXTOUT("(9)          6 裁雨留虹",-15,L9(12),4,RGB(60,80,230));
TEXTOUT("(Shift和0)   2 抛射物保护",-15,L9(13),4,RGB(60,80,230));
TEXTOUT("(Shift和.)   6 南蛮冲撞",-15,L9(14),4,RGB(60,80,230));
TEXTOUT("(Shift和空)  6堡垒机关枪",-15,L9(15),4,RGB(60,80,230));
TEXTOUT("(Shift和1)   3 电弧陷阱",-15,L9(16),4,RGB(60,80,230));
TEXTOUT("(Shift和2)   4 钻井",-15,L9(17),4,RGB(60,80,230));
TEXTOUT("(Shift和3)   4 半程追踪弹",-15,L9(18),4,RGB(60,80,230));
TEXTOUT("(Shift和4)   6 散装弹",-15,L9(19),4,RGB(60,80,230));
TEXTOUT("(Shift和5)   2 战墙",-15,L9(20),4,RGB(60,80,230));
TEXTOUT("(Shift和6)   4 充能左轮枪",-15,L9(21),4,RGB(60,80,230));
TEXTOUT("(Shift和7)   4 爆炸网球",-15,L9(22),4,RGB(60,80,230));

RECT(-15.9,10.9,2,9.5,RGB(0,0,0),RGB(255,255,255));
TEXTOUT("快捷键    点数  名称",-15.8,10.9,3,RGB(200,120,90));
WAIT(0.08);
END;    //..UP AND DOWN
IF ISKEYDOWN(0) OR ISKEYDOWN(30) THEN POS(L9,6)?S; END;
IF ISKEYDOWN(4) THEN S:=0; BLIT(G1); Sua:=0; END;
UNTIL S≠1.11 END;

//CHOOSE("仄里是技能菜单! Esc退回","(0)2 伤嗨嗨嗨UP","(.)3 进行瞬移","(空格)4 皇加超重蛋","(1)5 空对地导蛋彈","(2)10 天姫,参上!","(3)8 爆炸飞羊","(4)7 Forx3导弹","(5)3 护盾充能",
//"(6)6 天降正义!","(7)4 移动到平台","(8)3 升竜拳!","(9)7 裁雨留虹","(Shift和0)3 抛射物保护","(Shift和.)6 南蛮冲撞","(Shift和空格)6 堡垒机关枪","(Shift和1)5 电弧陷阱");
 IF S=1.11 THEN BLIT(G1); Sua:=0; END;
 IF S≥1 THEN
   IF S=1 THEN MSGBOX("伤害*2"); END;
   IF S=2 THEN MSGBOX("瞬移到光标处"); END;
   IF S=3 THEN MSGBOX("基础伤害300，无视风，对护盾伤害*1.3，伤害半径+1.5"); END;
   IF S=4 THEN MSGBOX("固定伤害450，无视风，在光标处投掷一枚炮弹，一定高度会增加50伤害。战姫撞墙后会对周围造成550伤害，并取消投弹。伤害半径+2"); END;
   IF S=5 THEN MSGBOX("固定伤害1000，从上至下检索障碍物，遇到障碍物时爆炸，伤害半径+7"); END;
   IF S=6 THEN MSGBOX("固定伤害850，在当前攻击方向放一只羊(移动方向随机)，按下Enter后向上方起飞，之后轮盘操控(左或上逆时针旋转)，超过10秒后消失，伤害半径+5"); END;
   IF S=7 THEN MSGBOX("根据距离计算伤害，发射10枚，在第2枚之后随机改变抛射角与初力度"); END;
   IF S=8 THEN MSGBOX("回复220护盾值(换回合后生效)"); END;
   IF S=9 THEN MSGBOX("自己扣200，重力势能与动能计算伤害，把自己当炮弹抛射，略受风影响，可以蹬墙跳，若没有命中玩家则不消耗点数。伤害半径+3.1"); END;
   IF S=10 THEN MSGBOX("瞬移到光标处，然后脚下生成平台"); END;
   IF S=11 THEN MSGBOX("固定伤害200，在当前攻击方向把身边的敌人抛高高"); END;
   IF S=12 THEN MSGBOX("固定85一枚炮弹，在光标范围处降下17枚炮弹，击中有血条目标时回复50护盾值，伤害半径-8"); END;
   IF S=13 THEN MSGBOX("被动，当炮弹即将对自己造成伤害时弹开 (只对普通炮弹、超重弹、散装弹、空对地导彈、Forx3生效)"); END;
   IF S=14 THEN MSGBOX("在攻击方向放一头牛(移动方向固定)，撞到玩家时，造成200伤害并随机向后抛出，遇到障碍物会爆炸并对附近造成120伤害，时间超过3秒后消失，伤害半径+2"); END;
   IF S=15 THEN MSGBOX("在附近架一台500血的机枪，当有敌人位置变化时自动发射6枚机炮(直线，每颗35伤害，结束后不再射击)，血条清空时对附近玩家造成220伤害(会暴击)，伤害半径-1"); END;
   IF S=16 THEN MSGBOX("固定伤害250，直线投出，被击中玩家下回合不能使用技能，不能移动，伤害8折，伤害半径+1"); END;
   IF S=17 THEN MSGBOX("固定380，在光标处降下一枚穿图弹，直至打中目标或钻井时间耗尽，伤害半径+2"); END;
   IF S=18 THEN MSGBOX("基础420，抛出1秒后以直线飞向光标处"); END;
   IF S=19 THEN MSGBOX("基础200，击中目标/障碍物后在炮弹处再散发7枚炮弹，伤害半径+1"); END;
   IF S=20 THEN MSGBOX("在攻击方向放一堵墙"); END;
   IF S=21 THEN MSGBOX("原始伤害63每枪，总共6发，每开两枪需再次瞄准，可以使用护盾为枪充能（按+键与-键），每次充能支付100护盾，伤害加40，再次瞄准后变回63，伤害半径-6.5"); END;
   IF S=22 THEN MSGBOX("基本伤害400,向预瞄线抛出,具有球的特性,按Shift可调整爆炸延迟"); END;
   BLIT(G1); Sua:=0; S:=-2;
  END;   //   S  1.11
L9:=0; T:=0;
END;

IF Sua=0 AND S≠-1 THEN
TEXTOUT("FLUE",-15.8,10.7,2);
RECT(-15.6,9.4,-14,4,RGB(120,0,120),RGB(255,255,255));
TEXTOUT("当前力度:",-12.7,10.8,2,RGB(20,55,20));
RECT(-13.7,9.4,-3.3,8.3,RGB(120,120,255),RGB(255,255,255));
TEXTOUT("总燃油剩下:     ",-13.5,8,2,RGB(200,150,150));
//RECT(-3,10.7,2,4,RGB(50,50,50),RGB(255,255,255));
TEXTOUT("回合:",-2.8,10.5,2,RGB(150,150,240));
TEXTOUT("Points:",-13.5,6.8,3,RGB(120,150,200));
TEXTOUT("生命:",3,10.9,4,RGB(200,120,120));
//RECT(7,10.9,16,10);
RECT(2.8,9,15.2,7.5,RGB(200,0,0),RGB(255,255,255));
TEXTOUT("护盾:",3,7.2,3,RGB(120,130,255));
TEXTOUT("当前技能:",2.5,5.5,3,RGB(0,0,100));
END;
END;

EXPORT CharEdit()
BEGIN
LOCAL x0,y0,Devia,Posi,Mode,Side,Alfa;
LOCAL CharR,CharG,CharB,Size,CharM,PosX,PosY;
RECT;
STARTAPP("Function");STARTVIEW(-7);
R:=255;G:=200;B:=200; C:=2; CharR:=0; CharG:=0; CharB:=0; 
A:=5; C:=2; D:=6.66; P:=-1;W:=0.003; L0:={}; Size:=1;

CHOOSE(O,"确定要清屏?","确认","不想");
 IF O=1 THEN
 DIMGROB(G1,32,24);
 END;
WAIT(.5);
IF GROBW(G1)≠32 THEN DIMGROB(G1,32,24); END;
DIMGROB(G3,32,24);
BLIT(G1);

WHILE D=6.66 DO
IF MOUSE(0)≠-1 AND MOUSE(1)≠-1 THEN MOUSE(0)/10-16?X; -MOUSE(1)/10+11?Y; x0:=X; y0:=Y; END;
IF (ISKEYDOWN(7) OR ISKEYDOWN(8) OR ISKEYDOWN(2) OR ISKEYDOWN(12)) OR (MOUSE(0)≠-1 AND MOUSE(1)≠-1) OR K=37 THEN
 WAIT(W);  BLIT(G1); INVERT(x0,y0,x0,y0); K:=-1;
      IF ISKEYDOWN(19) AND SIZE(L0)=0 THEN ARC(x0,y0,2+A,{RGB(0,0,0),RGB(255,255,255)}); END;
   IF ISKEYDOWN(7) THEN  x0:=x0-0.1; END; 
   IF ISKEYDOWN(8) THEN  x0:=x0+0.1; END;
   IF ISKEYDOWN(2) THEN  y0:=y0+0.1; END;
   IF ISKEYDOWN(12) THEN y0:=y0-0.1; END;
   IF x0>16 THEN x0:=-16; END;  IF x0<-16 THEN x0:=16; END;  IF y0<-12.9 THEN y0:=10.9; END;  IF y0>10.9 THEN y0:=-12.9; END;
   IF Posi≠0 THEN TEXTOUT({x0,y0},-15.6,-10,3,RGB(200,80,255),200,RGB(255,255,255)); END;
  IF SIZE(L0)=0 THEN 
   IF P=-1 THEN IF ISKEYDOWN(19)=0 THEN ARC(x0,y0,2+C,RGB(R,G,B)); END; ELSE ARC(x0,y0,2+C,P); END;
  ELSE
   IF Mode=0 THEN
    IF CharM=0 THEN TEXTOUT(L0(1),x0,y0+Devia,Size,RGB(R,G,B)); ELSE TEXTOUT(L0(1),x0,y0+Devia,Size,RGB(R,G,B),250,RGB(CharR,CharG,CharB));
    END;  //CharM=0
   ELSE
    LINE(x0-.3,y0+Devia,x0+.3,y0+Devia); LINE(x0,y0+Devia-0.3,x0,y0+Devia+0.3);
    IF Mode=1 THEN IF CharM=0 THEN RECT(L0(1),L0(2),x0,y0,RGB(R,G,B,Alfa),RGB(255,255,255)); ELSE RECT(L0(1),L0(2),x0,y0,RGB(R,G,B),RGB(CharR,CharG,CharB,Alfa)); END; END;
    IF Mode=2 THEN IF CharM=0 THEN ARC(L0(1),L0(2),ABS(x0-L0(1))*10,{RGB(R,G,B,Alfa),RGB(255,255,255)}); ELSE ARC(L0(1),L0(2),ABS(x0-L0(1))*10,{RGB(R,G,B),RGB(CharR,CharG,CharB,Alfa)}); END; END;
    IF Mode=3 THEN LINE(L0(1),L0(2),x0,y0,RGB(R,G,B,Alfa)); END;
   END;  //Mode
  END;  //Size(L0)
END;

IF (ISKEYDOWN(30) OR (MOUSE(0)≠-1 AND MOUSE(1)≠-1 AND SIZE(L0)=0)) AND ISKEYDOWN(19)=0 THEN
  IF SIZE(L0)=0 THEN
   IF P=-1 THEN ARC(G1,x0,y0+Devia,2+C,{RGB(R,G,B),RGB(R,G,B)});
   ELSE  ARC(G1,x0,y0+Devia,2+C,{P,P});
   END;
  ELSE
   IF Mode=0 THEN
    IF CharM=0 THEN TEXTOUT(L0(1),G1,x0,y0+Devia,Size,RGB(R,G,B)); ELSE TEXTOUT(L0(1),G1,x0,y0+Devia,Size,RGB(R,G,B),500,RGB(CharR,CharG,CharB)); END; //CharM=0
   ELSE
IF Mode=1 THEN IF CharM=0 THEN RECT(G1,L0(1),L0(2),x0,y0,RGB(R,G,B,Alfa),RGB(255,255,255)); ELSE RECT(G1,L0(1),L0(2),x0,y0,RGB(R,G,B,Alfa),RGB(CharR,CharG,CharB)); END; END;
IF Mode=2 THEN IF CharM=0 THEN ARC(G1,L0(1),L0(2),ABS(x0-L0(1))*10,{RGB(R,G,B,Alfa),RGB(255,255,255)}); ELSE ARC(G1,L0(1),L0(2),ABS(x0-L0(1))*10,{RGB(R,G,B,Alfa),RGB(CharR,CharG,CharB)}); END; END;
IF Mode=3 THEN LINE(G1,L0(1),L0(2),x0,y0,RGB(R,G,B,Alfa)); END;
 Mode:=0; L0:={}; END;
  WAIT(0.2);
  END;
BLIT(G1);
END;

IF ISKEYDOWN(20) OR ISKEYDOWN(21) OR ISKEYDOWN(22) OR ISKEYDOWN(23) THEN
 IF ISKEYDOWN(20) THEN CHOOSE(Mode,"绘制多辺形","矩形,快捷键:SIN","圆形,快捷键:COS"); END; 
 IF ISKEYDOWN(21) AND Mode≠1 THEN Mode:=1;   TEXTOUT("绘制矩形",-15.6,10,3,RGB(200,80,255),200,RGB(255,255,255)); END;
 IF ISKEYDOWN(22) AND Mode≠2 THEN Mode:=2;   TEXTOUT("绘制圆形",-15.6,10,3,RGB(200,80,255),200,RGB(255,255,255)); END;
 IF ISKEYDOWN(23) AND Mode≠3 THEN Mode:=3;   TEXTOUT("绘制直线",-15.6,10,3,RGB(200,80,255),200,RGB(255,255,255)); END;
 L0(1):=x0; L0(2):=y0;
END;

IF ISKEYDOWN(35) THEN Z:=3; CHOOSE(Z,"载入地图文件","先保存当前地图文件","载入地图文件","取消");
 IF Z=1 THEN K:=40; END;
 IF Z=2 THEN L0:={}; INPUT(L0,"载入地图文件","载入 地图","输入名称注意:必须加双引号"); AFiles(L0(1))?G1; L0:={}; END;
 BLIT(G1); WAIT(0.12);
END;

IF ISKEYDOWN(40) OR K=40 THEN WAIT(0.1);
 IF ISKEYDOWN(19) THEN L0:={};
  INPUT(L0,"删除 地图文件","删除 地图","输入名称注意:必须加双引号");
  IF SIZE(L0)=1 THEN Z:=2; CHOOSE(Z,"注意:确认要删掉 "+L0(1),"是","否"); 
   IF Z=1 THEN DelAFiles(L0(1)); MSGBOX("已删掉 "+L0(1));
   END;
  END;
ELSE
L0:={}; K:=-1; INPUT(L0,"保存 地图文件","保存 地图","输入名称注意:必须加双引号"); 
IF SIZE(L0)=1 THEN DelAFiles(L0(1)); G1?AFiles(L0(1)); MSGBOX("已保存 "+L0(1)); END;
END;
L0:={}; BLIT(G1); WAIT(0.12);
END;

IF ISKEYDOWN(41) AND SIZE(L0)≠0 THEN
 IF CharR<0 OR CharG<0 OR CharB<0 THEN
  TEXTOUT("请先设置背色",-15.6,10,3,RGB(200,80,255),200,RGB(255,255,255)); 
 ELSE 
   IF CharM=1 THEN CharM:=0; ELSE CharM:=1; END;
   WAIT(0.12);
 END;  //CharM
END;

IF ISKEYDOWN(41) AND (ISKEYDOWN(45) OR ISKEYDOWN(50)) THEN
  IF ISKEYDOWN(45) THEN Devia:=Devia-0.1; END; 
  IF ISKEYDOWN(50) THEN Devia:=Devia+0.1; END;
 BLIT(G1);
 ARC(-15,6,2+C,RGB(R,G,B)); ARC(-15,6+Devia,2+C,RGB(R,G,B));
 PIXON(-15,6); PIXON(-15,6+Devia);
 TEXTOUT("偏移值 "+Devia,-15.6,10,3,RGB(200,80,255),200,RGB(255,255,255)); 
 WAIT(0.01);
END;
IF ISKEYDOWN(50) AND ISKEYDOWN(19)=0 AND ISKEYDOWN(41)=0 THEN
 IF SIZE(L0)=0 THEN
  C:=C+0.2; 
  TEXTOUT("像素半径"+C,-15.6,10,3,RGB(200,80,255),200,RGB(255,255,255));
  ARC(-14,5,2+C,RGB(R,G,B));
 ELSE
  IF Mode=0 THEN 
   IF Size≤6 THEN Size:=Size+1; END;
   TEXTOUT("字体大小"+Size,-15.6,10,3,RGB(200,80,255),200,RGB(255,255,255));
   TEXTOUT("字体",-15.6,8,Size,RGB(200,80,255),200,RGB(255,255,255));
  END;
 END;
 WAIT(0.15); BLIT(G1);
END;
IF ISKEYDOWN(45) AND ISKEYDOWN(19)=0 AND ISKEYDOWN(41)=0 THEN
 IF SIZE(L0)=0 THEN
  C:=C-0.2;
  TEXTOUT("像素半径"+C,-15.6,10,3,RGB(200,80,255),200,RGB(255,255,255));
  ARC(-14,5,2+C,RGB(R,G,B));
 ELSE
  IF Mode=0 THEN
   IF 2≤Size THEN Size:=Size-1; END;
   TEXTOUT("字体大小"+Size,-15.6,10,3,RGB(200,80,255),200,RGB(255,255,255));
   TEXTOUT("字体",-15.6,8,Size,RGB(200,80,255),200,RGB(255,255,255));
  END;
 END;
 WAIT(0.15); BLIT(G1);
END;

IF ISKEYDOWN(32) OR ISKEYDOWN(34) THEN
K:=37;
IF ISKEYDOWN(34) AND Alfa<255 THEN Alfa:=Alfa+1; END;
IF ISKEYDOWN(32) AND Alfa>0 THEN Alfa:=Alfa-1; END;
TEXTOUT("透明度: "+Alfa,-15.6,10.5,3); WAIT(0.05);
END;

IF ISKEYDOWN(37) OR ISKEYDOWN(38) OR ISKEYDOWN(39) OR ISKEYDOWN(42) OR ISKEYDOWN(43) OR ISKEYDOWN(44) THEN 
K:=37;
IF ISKEYDOWN(37) THEN IF CharM=0 THEN IF R<255 THEN R:=R+1; END; ELSE IF CharR<255 THEN CharR:=CharR+1; END; END; END;
IF ISKEYDOWN(38) THEN IF CharM=0 THEN IF G<255 THEN G:=G+1; END; ELSE IF CharG<255 THEN CharG:=CharG+1; END; END; END;
IF ISKEYDOWN(39) THEN IF CharM=0 THEN IF B<255 THEN B:=B+1; END; ELSE IF CharB<255 THEN CharB:=CharB+1; END; END; END;
IF ISKEYDOWN(42) THEN IF CharM=0 THEN IF R>0 THEN R:=R-1; END;   ELSE IF CharR>0 THEN CharR:=CharR-1; END; END; END;
IF ISKEYDOWN(43) THEN IF CharM=0 THEN IF G>0 THEN G:=G-1; END;   ELSE IF CharG>0 THEN CharG:=CharG-1; END; END; END;
IF ISKEYDOWN(44) THEN IF CharM=0 THEN IF B>0 THEN B:=B-1; END;   ELSE IF CharB>0 THEN CharB:=CharB-1; END; END; END;
 IF CharM=0 THEN
  RECT(-15.6,5,-13.6,3,RGB(R,G,B),RGB(R,G,B));
  TEXTOUT([R,G,B],-15.6,2,3);
 ELSE
  RECT(-15.6,5,-13.6,3,RGB(CharR,CharG,CharB),RGB(CharR,CharG,CharB));
  TEXTOUT([CharR,CharG,CharB],-15.6,2,3);
 END;
 WAIT(0.05);
END;

IF ISKEYDOWN(9) OR K=4.4 THEN
P:=GETPIX(x0,y0);
RECT(-15.9,10.9,-13.9,8.9,P);
 IF ISKEYDOWN(41) OR K=4.4 THEN
  IF GROBW(G4)≠24 OR K=4.4 THEN
  DIMGROB(G4,24,24); RECT;
  TEXTOUT("初始化色板中",-4.5,8,4,RGB(230,140,80));
   FOR X FROM 0 TO 240 DO
    TEXTOUT(ROUND(X/2.4,2)+"%",-4.5,6,4,RGB(160,240,200),100,RGB(255,255,255));
    ARC(0,0,40,0,360,{RGB(255,255,255),RGB(255,255,255)});
    ARC(0,0,40,1.5*X,0,{RGB(55,230,155),RGB(55,180,255)});
    FOR Y FROM 0 TO 240 DO
    R:=Y*1.0625; G:=255-X*1.0625; B:=255-Y*1.0625;
    PIXON_P(G4,X,Y,RGB(R,G,B)); 
    END;
   END;
  END;
   BLIT(G4); K:=-1; L0:={};
   TEXTOUT("色板",10.6,10.9,4,RGB(55,180,255),150,RGB(255,255,255));
   TEXTOUT("Esc退出",9,9,4,RGB(55,180,255),150,RGB(255,255,255));
   TEXTOUT("Del重新初始化",8.5,7,3,RGB(55,180,255),150,RGB(255,255,255));
  WHILE ISKEYDOWN(4)=0 AND K≠4.4 DO
   IF (MOUSE(0)≠-1 AND MOUSE(1)≠-1) OR ISKEYDOWN(7) OR ISKEYDOWN(8) OR ISKEYDOWN(2) OR ISKEYDOWN(12) THEN 
    IF MOUSE(0)≠-1 AND MOUSE(1)≠-1 THEN L0:=PX→C(MOUSE(0),MOUSE(1)); x0:=L0(1); y0:=L0(2); END; 
    IF ISKEYDOWN(7) THEN  x0:=x0-0.1; END; 
    IF ISKEYDOWN(8) THEN  x0:=x0+0.1; END;
    IF ISKEYDOWN(2) THEN  y0:=y0+0.1; END;
    IF ISKEYDOWN(12) THEN y0:=y0-0.1; END;
    IF x0>7.8 THEN x0:=-16; END;  IF x0<-16 THEN x0:=7.8; END;  
    IF y0<-12.9 THEN y0:=10.9; END; IF y0>10.9 THEN y0:=-12.9; END;
   WAIT(0.01); BLIT(G4); L0:=C→PX(x0,y0); P:=GETPIX(x0,y0);
   RECT(x0-.1,y0+.1,x0+.1,y0-.1,RGB(255,255,255),0);
   RECT(8,2,16,.5);
   TEXTOUT({ROUND(L0(2)*1.0625,0),ROUND(255-L0(1)*1.0625,0),ROUND(255-L0(2)*1.0625,0)},8,2,2,RGB(90,200,255));
   RECT(15.9,4.5,13.9,2.5,P); 
   END;
  IF ISKEYDOWN(19) THEN K:=4.4; MSGBOX("重新初始化色板"); END;
  END;  //While
 BLIT(G1); L0:={}; WAIT(0.2);
 END; //41
END;  //9

IF P≠-1 AND ISKEYDOWN(13) THEN P:=-1; TEXTOUT("已取消取色",-15.8,8.5,3,RGB(240,60,60),100,RGB(255,255,255)); END;

IF ISKEYDOWN(15) THEN
INPUT({R,G,B,C,A,W,Devia,CharR,CharG,CharB,Alfa,Posi,x0,y0},"输入",{"Red","Green","Blue","像素半径","像皮擦半径","轮盘延迟","偏移值",
 "背色Red","背色Green","背色Blue","透明度","非0显示坐标","坐标x","坐标y"},
 "不得超过255,取消后返回");
 IF Alfa<0 THEN Alfa:=0; END; IF Alfa>255 THEN Alfa:=255; END;
 IF CharR>-1 AND CharG>-1 AND CharB>-1 THEN CharM:=1; ELSE CharM:=0; END;
WAIT(0.3);BLIT(G1);
END;
 
IF ISKEYDOWN(5) THEN O:=2;
 CHOOSE(O,"确定要清屏?","确认","不想");
 IF O=1 THEN
 DIMGROB(G1,32,24);
 END;
 BLIT(G1); WAIT(0.2);
END;

IF ISKEYDOWN(14) THEN
 INPUT(L0,"输入字符",""); BLIT(G1); WAIT(0.2);
END;

IF ISKEYDOWN(4) THEN D:=-1.11; C:=6.66; END;
  
IF ISKEYDOWN(19) THEN
 IF SIZE(L0)≥1 THEN L0:={};
 ELSE Z:=1;
  IF ISKEYDOWN(7) OR ISKEYDOWN(8) OR ISKEYDOWN(2) OR ISKEYDOWN(12) THEN
  ARC(G1,x0,y0,2+A,{RGB(255,255,255),RGB(255,255,255)});
  ELSE
   IF MOUSE(0)≠-1 AND MOUSE(1)≠-1 THEN
   ARC(X,Y+Devia,2+A,{RGB(0,0,0),RGB(255,255,255)});
   ARC(G1,X,Y+Devia,2+A,{RGB(255,255,255),RGB(255,255,255)});
   END;
  END;
   IF ISKEYDOWN(50) THEN
   A:=0.5+A;
   TEXTOUT("像皮擦半径"+A,-15.6,10,3,RGB(200,80,255));
   ARC(-14,5,2+A,RGB(0,0,0));
   WAIT(0.15); BLIT(G1);
   END;
   IF ISKEYDOWN(45) THEN
   A:=A-.5;
   TEXTOUT("像皮擦半径"+A,-15.6,10,3,RGB(200,80,255));
   ARC(-14,5,2+A,RGB(0,0,0));
   WAIT(0.15); BLIT(G1);
   END;
 END;
  BLIT(G1);
  ELSE
  0?Z;
  END;
END;
  IF D=-1.11 AND C=6.66 THEN D:=0; Cover; END; 
END;

	char SkillDes[23][255] = {
{"跳过本回合，并b+2点数，o+5油"},
{"伤害r*2"},
{"瞬移到光标处"},
{"基础伤害r300，伤害半径p+1.5，无视风，对护盾伤害r*1.3"},
{"固定伤害r450，伤害半径p+2，无视风，往光标处投掷一枚炮弹。战姫撞墙后会对周围造成r550伤害，并取消投弹(若没有抛出)。"},
{"固定伤害r1000，伤害半径p+7，激光从上至下检索障碍物，遇到障碍物时轰炸"},
{"固定伤害r850，伤害半径p+5，在当前攻击方向放一只羊(移动方向随机)，按下Enter后向上方起飞，之后方向操控(W或A逆时针旋转)，超过15秒后(自动起飞或)消失"},
{"根据水平距离计算伤害，发射10枚，随机改变抛射角与力度"},
{"回复b300护盾值(换回合后生效)"},
{"固定伤害r1000，斩击目标处"},
{"瞬移到光标处，然后脚下生成平台"},
{"固定伤害r200，在当前攻击方向把身边的敌人抛高高"},
{"固定r85一枚雨，伤害半径p-8，在光标范围处降下17枚雨，击中有血条目标时回复b50护盾值"},
{"被动，当炮弹即将对自己造成伤害时弹开 (后面带弹字的都生效)，之后失效"},
{"基础伤害r200，伤害半径p+2，在攻击方向放一头牛(移动方向固定)，撞到玩家时，造成r200伤害并随机向后抛出，遇到障碍物会爆炸并对附近造成r120伤害，一定次数后消失"},
{"在附近架一台o500血的机炮，当有敌人位置变化时自动发射6枚子炮(直线，每颗r35伤害，结束后本回合不再射击)，血条清空时对附近玩家造成基础伤害r220，伤害半径p-1"},
{"固定伤害r250，伤害半径p+1，直线投出，被击中玩家下回合不能使用技能，不能移动，伤害8折"},
{"固定伤害r380，伤害半径p+2，从上往下钻井，直至打中目标或钻井时间耗尽"},
{"基础伤害r420，抛出1秒后以直线飞向光标处"},
{"基础伤害r200，伤害半径p+1，击中目标/障碍物后在炮弹处再散发7枚炮弹"},
{"在攻击方向放一堵墙"},
{"伤害半径p-6.5，原始伤害r63每枪，总共6发，每开两枪需再次瞄准(直线射击)，可以使用护盾为枪充能（按+键与-键），每次充能支付b100护盾，伤害加r40，再次瞄准后变回r63"},
{"基础伤害r400，向预瞄线抛出，具有球的特性，按Shift可调整爆炸延迟"}
	};
